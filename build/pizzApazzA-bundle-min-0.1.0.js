window.onload=a=>{switch(localStorage.getItem("z4language")){case"en":Translations.setEnglish(),Z4Translations.setEnglish();break;case"it":Translations.setItalian(),Z4Translations.setItalian()}switch(localStorage.getItem("z4theme")){case"light":break;case"dark":SwingJS.instance().darkMode(!0).build();break;default:SwingJS.instance().darkMode(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches).build()}new Z4Frame};class Z4Frame extends JSFrame{ribbon=new Z4Ribbon;canvas=new Z4Canvas;constructor(){super(),this.cssAddClass("z4frame"),this.getContentPane().setLayout(new BorderLayout(5,5)),this.getContentPane().add(this.ribbon,BorderLayout.NORTH),this.getContentPane().add(this.canvas,BorderLayout.CENTER)}}class Z4RibbonFilePanel extends JSPanel{constructor(){super(),this.setLayout(new GridBagLayout),this.cssAddClass("z4ribbonfilepanel"),this.addLabel(Z4Translations.NEW,0),this.addButton(Z4Translations.CREATE,0,1,null),this.addButton(Z4Translations.CREATE_FROM_CLIPBOARD,1,1,null),this.addVLine(2,0),this.addLabel(Z4Translations.OPEN,3),this.addButton(Z4Translations.OPEN_FROM_DEVICE,3,1,a=>this.openFromDevice()),this.addButton(Z4Translations.OPEN_FROM_BROWSER,4,1,null),this.addVLine(5,0),this.addLabel(Z4Translations.SAVE,6),this.addButton(Z4Translations.SAVE,6,1,null),this.addButton(Z4Translations.SAVE_AS,7,1,null),this.addVLine(8,1)}addLabel(a,s){let t=new JSLabel;t.setText(a);let e=new GridBagConstraints;e.gridx=s,e.gridy=0,e.anchor=GridBagConstraints.WEST,e.insets=new Insets(5,5,2,0),this.add(t,e)}addButton(a,s,t,e){let n=new JSButton;n.setText(a),n.setContentAreaFilled(!1),n.addActionListener(e);let i=new GridBagConstraints;i.gridx=s,i.gridy=t,i.insets=new Insets(0,5,0,5),this.add(n,i)}addVLine(a,s){let t=new JSComponent(document.createElement("div"));t.getStyle().width="1px",t.getStyle().background="var(--main-action-bgcolor";let e=new GridBagConstraints;e.gridx=a,e.gridy=0,e.gridheight=2,e.fill=GridBagConstraints.VERTICAL,e.weightx=s,e.weighty=1,e.insets=new Insets(1,2,1,2),this.add(t,e)}openFromDevice(){JSFileChooser.showOpenDialog(".gif,.png,.jpeg,.jpg,.z4i",JSFileChooser.SINGLE_SELECTION,0,a=>{a.forEach(a=>{})})}}class Z4RibbonSettingsPanel extends JSPanel{language=new JSComboBox;theme=new JSComboBox;constructor(){super(),this.setLayout(new GridBagLayout),this.cssAddClass("z4ribbonsettingspanel");let a=new JSLabel;a.setText(Z4Translations.LANGUAGE);let s=new GridBagConstraints;s.gridx=0,s.gridy=0,s.anchor=GridBagConstraints.WEST,s.insets=new Insets(5,5,2,0),this.add(a,s);let t=new DefaultKeyValueComboBoxModelAndRenderer;t.addElement(new KeyValue("en",Z4Translations.LANGUAGE_ENGLISH_NATIVE)),t.addElement(new KeyValue("it",Z4Translations.LANGUAGE_ITALIAN_NATIVE)),this.language.setModelAndRenderer(t),this.language.setSelectedItem(Z4Translations.CURRENT_LANGUAGE),this.language.addActionListener(a=>this.onchangeLanguage()),(s=new GridBagConstraints).gridx=0,s.gridy=1,s.fill=GridBagConstraints.HORIZONTAL,s.insets=new Insets(0,5,0,5),this.add(this.language,s),(a=new JSLabel).setText(Z4Translations.THEME),(s=new GridBagConstraints).gridx=1,s.gridy=0,s.anchor=GridBagConstraints.WEST,s.insets=new Insets(5,5,2,0),this.add(a,s);let e=null;switch(localStorage.getItem("z4theme")){case"light":e=new KeyValue("light",Z4Translations.THEME_LIGHT);break;case"dark":e=new KeyValue("dark",Z4Translations.THEME_DARK);break;default:e=new KeyValue("auto",Z4Translations.THEME_AUTO)}let n=new DefaultKeyValueComboBoxModelAndRenderer;n.addElement(new KeyValue("auto",Z4Translations.THEME_AUTO)),n.addElement(new KeyValue("light",Z4Translations.THEME_LIGHT)),n.addElement(new KeyValue("dark",Z4Translations.THEME_DARK)),this.theme.setModelAndRenderer(n),this.theme.setSelectedItem(e),this.theme.addActionListener(a=>this.onchangeTheme()),(s=new GridBagConstraints).gridx=1,s.gridy=1,s.fill=GridBagConstraints.HORIZONTAL,s.insets=new Insets(0,5,0,5),this.add(this.theme,s),a=new JSLabel,(s=new GridBagConstraints).gridx=2,s.gridy=0,s.fill=GridBagConstraints.BOTH,s.weightx=1,this.add(a,s)}onchangeLanguage(){localStorage.setItem("z4language",this.language.getSelectedItem().key),JSOptionPane.showMessageDialog(Z4Translations.REFRESH_PAGE_MESSAGE,Z4Translations.LANGUAGE,JSOptionPane.INFORMATION_MESSAGE,null)}onchangeTheme(){localStorage.setItem("z4theme",this.theme.getSelectedItem().key),JSOptionPane.showMessageDialog(Z4Translations.REFRESH_PAGE_MESSAGE,Z4Translations.THEME,JSOptionPane.INFORMATION_MESSAGE,null)}}class Z4Ribbon extends JSTabbedPane{constructor(){super(),this.cssAddClass("z4ribbon"),this.addTab(Z4Translations.FILE,new Z4RibbonFilePanel),this.addTab(Z4Translations.SETTINGS,new Z4RibbonSettingsPanel)}}class Z4Canvas extends JSComponent{canvas=document.createElement("canvas");ctx=this.canvas.getContext("2d");chessboard=null;resizeObserver=new ResizeObserver(()=>this.drawCanvas());paper=new Z4Paper;static WIDTH=500;static HEIGHT=500;constructor(){super(document.createElement("div")),this.cssAddClass("z4canvas"),this.resizeObserver.observe(this.canvas),this.canvas.width=Z4Canvas.WIDTH,this.canvas.height=Z4Canvas.HEIGHT,this.appendNodeChild(this.canvas),this.addLayer(Z4Canvas.WIDTH,Z4Canvas.HEIGHT);let a=document.createElement("img");a.onload=s=>(this.chessboard=this.ctx.createPattern(a,"repeat"),this.drawCanvas(),null),a.src="image/chessboard.png"}addLayer(a,s){this.paper.addLayer(a,s),this.drawCanvas()}drawCanvas(){this.ctx.save(),this.ctx.fillStyle=this.chessboard,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore(),this.paper.drawPaper(this.ctx)}}class Z4Translations{static CURRENT_LANGUAGE=null;static FILE="";static NEW="";static CREATE="";static CREATE_FROM_CLIPBOARD="";static OPEN="";static OPEN_FROM_DEVICE="";static OPEN_FROM_BROWSER="";static SAVE="";static SAVE_AS="";static SETTINGS="";static LANGUAGE="";static LANGUAGE_ENGLISH_NATIVE="";static LANGUAGE_ITALIAN_NATIVE="";static THEME="";static THEME_AUTO="";static THEME_LIGHT="";static THEME_DARK="";static REFRESH_PAGE_MESSAGE="";static{switch(navigator.language.substring(0,2)){case"en":default:Z4Translations.setEnglish();break;case"it":Z4Translations.setItalian()}}constructor(){}static setEnglish(){Z4Translations.FILE="File",Z4Translations.NEW="New",Z4Translations.CREATE="Create",Z4Translations.CREATE_FROM_CLIPBOARD="Create from Clipboard",Z4Translations.OPEN="Open",Z4Translations.OPEN_FROM_DEVICE="Open from Device",Z4Translations.OPEN_FROM_BROWSER="Open from Browser",Z4Translations.SAVE="Save",Z4Translations.SAVE_AS="Save As...",Z4Translations.SETTINGS="Settings",Z4Translations.LANGUAGE="Language",Z4Translations.LANGUAGE_ENGLISH_NATIVE="English",Z4Translations.LANGUAGE_ITALIAN_NATIVE="Italiano",Z4Translations.THEME="Theme",Z4Translations.THEME_AUTO="Auto",Z4Translations.THEME_LIGHT="Light",Z4Translations.THEME_DARK="Dark",Z4Translations.REFRESH_PAGE_MESSAGE="Refresh the page to make the changes",Z4Translations.CURRENT_LANGUAGE=new KeyValue("en",Z4Translations.LANGUAGE_ENGLISH_NATIVE)}static setItalian(){Z4Translations.FILE="File",Z4Translations.NEW="Nuovo",Z4Translations.CREATE="Crea",Z4Translations.CREATE_FROM_CLIPBOARD="Crea dagli Appunti",Z4Translations.OPEN="Apri",Z4Translations.OPEN_FROM_DEVICE="Apri dal Dispositivo",Z4Translations.OPEN_FROM_BROWSER="Apri dal Browser",Z4Translations.SAVE="Salva",Z4Translations.SAVE_AS="Salva Come...",Z4Translations.SETTINGS="Impostazioni",Z4Translations.LANGUAGE="Lingua",Z4Translations.LANGUAGE_ENGLISH_NATIVE="English",Z4Translations.LANGUAGE_ITALIAN_NATIVE="Italiano",Z4Translations.THEME="Tema",Z4Translations.THEME_AUTO="Auto",Z4Translations.THEME_LIGHT="Chiaro",Z4Translations.THEME_DARK="Scuro",Z4Translations.REFRESH_PAGE_MESSAGE="Aggiorna la pagina per eseguire le modifiche",Z4Translations.CURRENT_LANGUAGE=new KeyValue("it",Z4Translations.LANGUAGE_ITALIAN_NATIVE)}}class Z4Layer{offscreen=null;offscreenCtx=null;offsetX=0;offsetY=0;constructor(a,s){this.offscreen=new OffscreenCanvas(a,s),this.offscreenCtx=this.offscreen.getContext("2d")}shiftLayer(a,s){this.offsetX=a,this.offsetY=s}drawLayer(a){a.drawImage(this.offscreen,this.offsetX,this.offsetY)}}class Z4Paper{layers=[];addLayer(a,s){this.layers.push(new Z4Layer(a,s))}drawPaper(a){this.layers.forEach(s=>s.drawLayer(a))}}