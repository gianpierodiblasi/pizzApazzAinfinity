class Z4Setting{static language=Z4Setting.initLanguage();static theme=Z4Setting.initTheme();static initLanguage(){let t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();if(i.startsWith("z4language"))return i.substring(11)}return navigator.languages?navigator.languages[0].substring(0,2):navigator.language?navigator.language.substring(0,2):navigator.userLanguage?navigator.userLanguage.substring(0,2):"en"}static initTheme(){Z4Setting.theme="auto";let t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();i.startsWith("z4theme")&&(Z4Setting.theme=i.substring(8))}return Z4Setting.setTheme(Z4Setting.theme),Z4Setting.theme}static setLanguage(t){let e=new Date;e.setTime(e.getTime()+31536e6),document.cookie="z4language="+t+";expires="+e.toUTCString()+";path="+Z4Loader.path,Z4Setting.language=t}static getLanguage(){return Z4Setting.language}static setTheme(t){Z4Setting.theme=t;let e=new Date;switch(e.setTime(e.getTime()+31536e6),document.cookie="z4theme="+t+";expires="+e.toUTCString()+";path="+Z4Loader.path,Z4Setting.theme){case"auto":window.matchMedia?Z4Setting.addDarkModeListener():document.body.classList.remove("z4-dark");break;case"light":document.body.classList.remove("z4-dark");break;case"dark":document.body.classList.add("z4-dark")}}static addDarkModeListener(){if("auto"===Z4Setting.theme){window.matchMedia("(prefers-color-scheme: dark)").matches?document.body.classList.add("z4-dark"):document.body.classList.remove("z4-dark");let t=new Object;t.once=!0,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>Z4Setting.addDarkModeListener()),t)}}static getTheme(){return Z4Setting.theme}constructor(){}}class Z4HTMLFactory{static HTML=Z4HTMLFactory.initHTML();static get(t){return Z4HTMLFactory.HTML[t]}static initHTML(){let t=new Array,e=new XMLHttpRequest;return Z4Loader.allFiles?(e.open("GET",Z4Loader.UP+"src/giada/html_list.properties?random="+Math.random(),!1),e.send(),new String(e.responseText).split("\n").forEach((i=>{i&&!i.startsWith("#")&&(e.open("GET",Z4Loader.UP+"src/"+i,!1),e.send(),t[i]=e.responseText)}))):(e.open("GET",Z4Loader.UP+"build/bundle-"+Z4Loader.version+".html",!1),e.send(),Z4HTMLFactory.readHTMLs(t,e.responseText)),t}static readHTMLs(t,e){new String(e).split("\n").forEach((e=>{if(e){let i=e.split(":=");t[i[0].trim()]=i[1].trim()}}))}constructor(){}}class Z4MessageFactory{static MESSAGE=Z4MessageFactory.initMessages();static get(t){return Z4MessageFactory.MESSAGE[t]}static changingLanguage(){Z4MessageFactory.MESSAGE=Z4MessageFactory.initMessages(),document.querySelectorAll("[data-token-lang-inner_text]").forEach((t=>t.innerHTML=Z4MessageFactory.get(t.getAttribute("data-token-lang-inner_text"))))}static initMessages(){let t=new Array,e=Z4Loader.UP+(Z4Loader.allFiles?"src/message/":"build/message/"),i=Z4Loader.allFiles?"message-"+Z4Setting.getLanguage()+".txt?random="+Math.random():"message-"+Z4Setting.getLanguage()+"-"+Z4Loader.version+".txt",s=new XMLHttpRequest;if(s.open("GET",e+i,!1),s.send(),Z4MessageFactory.readMessages(t,s.responseText),0===Object.keys(t).length){Z4Setting.setLanguage("en"),i=Z4Loader.allFiles?"message-en.txt?random="+Math.random():"message-en-"+Z4Loader.version+".txt";let s=new XMLHttpRequest;s.open("GET",e+i,!1),s.send(),Z4MessageFactory.readMessages(t,s.responseText)}return t}static readMessages(t,e){new String(e).split("\n").forEach((e=>{if(e&&!e.startsWith("#")){let i=e.split("=");t[i[0].trim()]=i[1].trim()}}))}constructor(){}}class Z4ImageFactory{static IMAGES=Z4ImageFactory.initImages();static get(t){return Z4ImageFactory.IMAGES[t]}static initImages(){let t=new Array,e=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/"),i=Z4Loader.allFiles?"image_list.properties?random="+Math.random():"image_list-"+Z4Loader.version+".properties",s=new XMLHttpRequest;return s.open("GET",e+i,!1),s.send(),Z4ImageFactory.readImages(e,t,new String(s.responseText).split("\n")),t}static readImages(t,e,i){i.forEach((s=>{if(s&&!s.startsWith("#")){let n=s.split("="),a=new Image;a.onload=s=>Z4ImageFactory.readImages(t,e,i.slice(1)),a.src=t+n[1].trim(),e[n[0].trim()]=a}}))}constructor(){}}class Z4AbstractComponentUI{root=null;devicePixelRatioListener=null;constructor(t){this.root=document.createElement("div"),this.root.id=this.getUniqueID(),this.root.innerHTML=t;let e=this.root.querySelectorAll("#"+this.root.id+" [data-token-lang-inner_text]");for(let t=0;t<e.length;t++){let i=e.item(t);i.innerHTML=Z4MessageFactory.get(i.getAttribute("data-token-lang-inner_text"))}}getUniqueID(){return"id"+(new Date).getTime()+"_"+parseInt(1e3*Math.random())}getUniqueName(){return"name"+(new Date).getTime()+"_"+parseInt(1e3*Math.random())}initDevicePixelRatio(t){window.matchMedia&&(this.devicePixelRatioListener=()=>{t(),this.addDevicePixelRatioListener()},this.addDevicePixelRatioListener())}addDevicePixelRatioListener(){let t=new Object;t.once=!0,window.matchMedia("(resolution: "+window.devicePixelRatio+"dppx)").addEventListener("change",this.devicePixelRatioListener,t)}disposeDevicePixelRatio(){window.matchMedia&&window.matchMedia("(resolution: "+window.devicePixelRatio+"dppx)").removeEventListener("change",this.devicePixelRatioListener)}dispose(){}querySelector(t){return this.root.querySelector(t)}querySelectorAll(t){return this.root.querySelectorAll(t)}appendToElement(t){return t.appendChild(this.root),this}insertBeforeElement(t){return t.parentElement.insertBefore(this.root,t),this}appendToComponent(t){return t.root.appendChild(this.root),this}prependElement(t){return this.root.prepend(t),this}prependComponent(t){return this.root.prepend(t.root),this}}class Z4AbstractComponentWithValueUI extends Z4AbstractComponentUI{value=null;onchange=t=>{};oninput=t=>{};constructor(t){super(t)}setValue(t){}getValue(){return this.value}}class Z4ModalMessageUI{static html=Z4ModalMessageUI.loadHTML();static modal=new bootstrap.Modal(Z4ModalMessageUI.html);static loadHTML(){let t=document.createElement("div");return t.id=(new Date).getTime()+"-"+parseInt(1e3*Math.random()),t.setAttribute("data-bs-backdrop","static"),t.setAttribute("data-bs-keyboard","false"),t.setAttribute("tabindex","-1"),t.setAttribute("style","display:none"),t.className="modal modal-dialog-centered fade",t.innerHTML=Z4HTMLFactory.get("giada/pizzapazza/ui/Z4ModalMessageUI.html"),document.body.appendChild(t),t}static showInfo(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-info-circle-fill","#0dcaf0")}static showWarning(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-exclamation-triangle-fill","#ffc107")}static showError(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-exclamation-octagon-fill","#dc3545")}static showOneButton(t,e,i,s,n){Z4ModalMessageUI.html.querySelector(".modal-title").innerHTML=t,Z4ModalMessageUI.html.querySelector(".modal-message").innerHTML=e;let a=Z4ModalMessageUI.html.querySelector(".modal-icon i");a.className=s,a.style.color=n;let r=Z4ModalMessageUI.html.querySelector(".modal-footer");r.innerHTML="",Z4ModalMessageUI.appendButton(Z4MessageFactory.get("OK"),"btn btn-primary",i,r),Z4ModalMessageUI.modal.show()}static showQuestion(t,e,i,s,n,a){let r=new Array,o=new Array,l=new Array;Z4ModalMessageUI.push("YES",i,!0,r,o,l),Z4ModalMessageUI.push("NO",s,!1,r,o,l),Z4ModalMessageUI.push("OK",n,!0,r,o,l),Z4ModalMessageUI.push("CANCEL",a,!1,r,o,l),Z4ModalMessageUI.showOpenQuestion(t,e,r,o,l)}static push(t,e,i,s,n,a){e&&(s.push(Z4MessageFactory.get(t)),n.push(e),a.push(i))}static showOpenQuestion(t,e,i,s,n){Z4ModalMessageUI.html.querySelector(".modal-title").innerHTML=t,Z4ModalMessageUI.html.querySelector(".modal-message").innerHTML=e;let a=Z4ModalMessageUI.html.querySelector(".modal-icon i");a.className="bi bi-question-circle-fill",a.style.color="#6c757d";let r=Z4ModalMessageUI.html.querySelector(".modal-footer");r.innerHTML="",i.forEach(((t,e,i)=>{Z4ModalMessageUI.appendButton(t,"btn "+(n[e]?"btn-primary":"btn-secondary"),s[e],r)})),Z4ModalMessageUI.modal.show()}static appendButton(t,e,i,s){let n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("data-bs-dismiss","modal"),n.className=e,n.innerHTML=t,n.onclick=t=>(i(),null),s.appendChild(n)}constructor(){}}class Z4Math{static TWO_PI=2*Math.PI;static HALF_PI=Math.PI/2;static GOLD_SECTION=(1+Math.sqrt(5))/2;static SQUARE_GOLD_SECTION=Z4Math.GOLD_SECTION*Z4Math.GOLD_SECTION;static RAD2DEG=180/Math.PI;static DEG2RAD=Math.PI/180;static rad2deg(t){return t*Z4Math.RAD2DEG}static deg2rad(t){return t*Z4Math.DEG2RAD}static distance(t,e,i,s){let n=t-i,a=e-s;return Math.sqrt(n*n+a*a)}static atan(t,e,i,s){let n=Math.atan2(s-e,i-t);return n<0?n+Z4Math.TWO_PI:n}static ripple(t,e,i,s){let n=(i-e)*s*Math.random();return(t+=Math.random()>.5?n:-n)<e?e:t>i?i:t}constructor(){}}class Z4Sign{static POSITIVE=new Z4Sign(1);static NEGATIVE=new Z4Sign(-1);static RANDOM=new Z4Sign(0);sign=0;constructor(t){this.sign=t}next(){switch(this.sign){case 1:case-1:return this.sign;case 0:default:return Math.random()>.5?1:-1;case 2:case-2:return this.sign*=-1,this.sign/2}}static alternate(){return new Z4Sign(-2)}}class Z4SignedValue{sign=Z4Sign.RANDOM;value=0;getSign(){return this.sign}setSign(t){return this.sign=t,this}getValue(){return this.value}setValue(t){return this.value=t,this}next(){return this.sign.next()*this.value}}class Z4SignedRandomValue{sign=Z4Sign.RANDOM;value=0;type=0;length=0;step=0;prevRandom=0;controlRandom=0;nextRandom=0;bezierCurve=null;constructor(t,e,i){this.value=t,this.type=e,this.length=i,this.step=1,this.prevRandom=Math.random(),this.controlRandom=1,this.nextRandom=Math.random(),1===this.type&&this.createBezierCurve()}createBezierCurve(){this.bezierCurve=new Bezier(0,this.prevRandom,this.length/2,this.controlRandom,1,this.nextRandom)}isClassic(){return 0===this.type}isBezier(){return 1===this.type}isPolyline(){return 2===this.type}isStepped(){return 3===this.type}getSign(){return this.sign}setSign(t){return this.sign=t,this}getValue(){return this.value}setValue(t){return this.value=t,this}getLength(){return this.length}setLength(t){return this.length=t,this}nextUnsigned(){switch(this.type){case 0:default:return this.value*Math.random();case 1:return this.step>=this.length?(this.step=1,this.prevRandom=this.nextRandom,this.controlRandom=1===this.controlRandom?0:1,this.nextRandom=Math.random(),this.createBezierCurve()):this.step++,this.value*this.bezierCurve.get(this.step/this.length).y;case 2:return this.step>=this.length?(this.step=1,this.prevRandom=this.nextRandom,this.nextRandom=Math.random()):this.step++,this.value*((this.nextRandom-this.prevRandom)*this.step/this.length+this.prevRandom);case 3:return this.step>=this.length?(this.step=1,this.prevRandom=Math.random()):this.step++,this.value*this.prevRandom}}nextSigned(){return this.sign.next()*this.nextUnsigned()}static classic(t){return new Z4SignedRandomValue(t,0,1)}static bezier(t,e){return new Z4SignedRandomValue(t,1,e)}static polyline(t,e){return new Z4SignedRandomValue(t,2,e)}static stepped(t,e){return new Z4SignedRandomValue(t,3,e)}}class Z4FancifulValue{constant=new Z4SignedValue;random=Z4SignedRandomValue.classic(0);uniformSign=!1;setConstant(t){return this.constant=t,this}getConstant(){return this.constant}setRandom(t){return this.random=t,this}getRandom(){return this.random}setUniformSign(t){return this.uniformSign=t,this}isUniformSign(){return this.uniformSign}next(){return this.uniformSign?this.constant.getSign().next()*(this.constant.getValue()+this.random.nextUnsigned()):this.constant.next()+this.random.nextSigned()}}class Z4Rotation{type=0;startAngle=0;angle=new Z4FancifulValue;delayed=!1;rotationNext=0;constructor(t){this.type=t}isFixed(){return 0===this.type}isCumulative(){return 1===this.type}isRelativeToPath(){return 2===this.type}getStartAngle(){return this.startAngle}setStartAngle(t){return this.startAngle=t,this}getAngle(){return this.angle}setAngle(t){return this.angle=t,this}isDelayed(){return this.delayed}setDelayed(t){return this.delayed=t,this}next(t){let e=Z4Math.deg2rad(this.startAngle+this.angle.next());switch(this.type){case 0:return e+(this.delayed?Math.PI:0);case 1:return this.rotationNext+=e,this.rotationNext+(this.delayed?Math.PI:0);case 2:return e+t+(this.delayed?Math.PI:0);default:return 0}}nextSide(t,e){switch(this.type){case 0:case 1:t.setSide(Z4Sign.POSITIVE);break;case 2:t.setSide(e?e.direction(t.getZ4Vector()):Z4Sign.RANDOM)}}static fixed(){return new Z4Rotation(0)}static cumulative(){return new Z4Rotation(1)}static relativeToPath(){return new Z4Rotation(2)}}class Z4Shape2D{static CIRCLE=new Z4Shape2D(0);static TRIANGLE=new Z4Shape2D(3);static SQUARE=new Z4Shape2D(-4);static DIAMOND=new Z4Shape2D(4);static PENTAGON=new Z4Shape2D(5);static HEXAGON=new Z4Shape2D(6);static SEPTAGON=new Z4Shape2D(7);static HEPTAGON=new Z4Shape2D(8);static STAR=new Z4Shape2D(-5);path=new Path2D;constructor(t){let e=.5,i=0,s=0;switch(t){case 0:this.path.arc(0,0,e,0,Z4Math.TWO_PI);break;case-4:this.path.rect(-.5,-.5,1,1);break;case-5:i=-Z4Math.HALF_PI,s=Z4Math.TWO_PI/5;let n=e/Z4Math.SQUARE_GOLD_SECTION;this.path.moveTo(Math.cos(i)*e,Math.sin(i)*e),i=3*s+Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*n,Math.sin(i)*n);for(let t=1;t<5;t++)i=s*t-Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*e,Math.sin(i)*e),i=s*(t+3)+Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*n,Math.sin(i)*n);break;default:i=-Z4Math.HALF_PI,s=Z4Math.TWO_PI/t,this.path.moveTo(Math.cos(i)*e,Math.sin(i)*e);for(let n=1;n<t;n++)i=s*n-Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*e,Math.sin(i)*e)}this.path.closePath()}getPath(){return this.path}}class Z4Vector{x0=0;y0=0;x=0;y=0;module=0;phase=0;constructor(t,e,i,s,n,a){this.x0=t,this.y0=e,this.x=i,this.y=s,this.module=n,this.phase=a}static fromPoints(t,e,i,s){return new Z4Vector(t,e,i,s,Z4Math.distance(t,e,i,s),Z4Math.atan(t,e,i,s))}static fromVector(t,e,i,s){return new Z4Vector(t,e,t+i*Math.cos(s),e+i*Math.sin(s),i,s)}clone(){return new Z4Vector(this.x0,this.y0,this.x,this.y,this.module,this.phase)}getX0(){return this.x0}getY0(){return this.y0}getX(){return this.x}getY(){return this.y}getModule(){return this.module}getPhase(){return this.phase}direction(t){let e=this.x-this.x0,i=this.y-this.y0,s=t.x-t.x0,n=t.y-t.y0;return Math.atan2(e*n-i*s,e*s+i*n)>=0?Z4Sign.POSITIVE:Z4Sign.NEGATIVE}}class Z4TracerPath{surplus=0;step=0;x1=0;y1=0;x2=0;y2=0;x3=0;y3=0;bezierCurve=null;bezierCurveLength=0;length=0;position=0;static fromLine(t,e,i,s,n,a){let r=new Z4TracerPath;return r.x1=t,r.y1=e,r.x2=i,r.y2=s,r.init(n,a)}static fromQuadAndLine(t,e,i,s,n,a,r,o,l,h){let u=new Z4TracerPath;return u.bezierCurve=new Bezier(t,e,i,s,n,a),u.bezierCurveLength=u.bezierCurve.length(),u.x2=n,u.y2=a,u.x3=r,u.y3=o,u.init(l,h)}init(t,e){return this.surplus=t,this.step=e,this.length=this.bezierCurve?this.bezierCurveLength+Z4Math.distance(this.x2,this.y2,this.x3,this.y3):Z4Math.distance(this.x1,this.y1,this.x2,this.y2),this.position=t,this}hasNext(){return this.length>this.position}next(){if(this.hasNext()){if(this.bezierCurve){if(this.position<this.bezierCurveLength){let t=this.position/this.bezierCurveLength,e=this.bezierCurve.get(t),i=this.bezierCurve.derivative(t);return this.position+=this.step,Z4Vector.fromPoints(e.x,e.y,e.x+i.x,e.y+i.y)}{let t=(this.position-this.bezierCurveLength)/(this.length-this.bezierCurveLength),e=(this.x3-this.x2)*t+this.x2,i=(this.y3-this.y2)*t+this.y2;return this.position+=this.step,Z4Vector.fromVector(e,i,1,Z4Math.atan(this.x2,this.y2,this.x3,this.y3))}}{let t=this.position/this.length,e=(this.x2-this.x1)*t+this.x1,i=(this.y2-this.y1)*t+this.y1;return this.position+=this.step,Z4Vector.fromVector(e,i,1,Z4Math.atan(this.x1,this.y1,this.x2,this.y2))}}return null}getTangentAt(t){return null}restart(){return this.position=this.surplus,this}getLength(){return this.length}getNewSurplus(){return this.position-this.length}getPointCount(){return parseInt((this.length-this.surplus)/this.step)}}class Z4Point{z4Vector=Z4Vector.fromPoints(0,0,1,1);intensity=1;lighting=Z4Lighting.NONE;colorPosition=-1;drawBounds=!1;side=Z4Sign.RANDOM;useVectorModuleAsSize=!1;clone(){let t=new Z4Point;return t.z4Vector=this.z4Vector.clone(),t.intensity=this.intensity,t.lighting=this.lighting,t.colorPosition=this.colorPosition,t.drawBounds=this.drawBounds,t.side=this.side,t.useVectorModuleAsSize=this.useVectorModuleAsSize,t}getZ4Vector(){return this.z4Vector}setZ4Vector(t){return this.z4Vector=t,this}getIntensity(){return this.intensity}setIntensity(t){return this.intensity=t,this}getLighting(){return this.lighting}setLighting(t){return this.lighting=t,this}getColorPosition(){return this.colorPosition}setColorPosition(t){return this.colorPosition=t,this}isDrawBounds(){return this.drawBounds}setDrawBounds(t){return this.drawBounds=t,this}setSide(t){return this.side=t,this}setUseVectorModuleAsSize(t){return this.useVectorModuleAsSize=t,this}isUseVectorModuleAsSize(){return this.useVectorModuleAsSize}}class Z4SignedValueUI extends Z4AbstractComponentWithValueUI{valueLabel=this.querySelector(".signed-value-value-label");radioSpinner=this.querySelector(".signed-value-radio-spinner");radioRange=this.querySelector(".signed-value-radio-range");spinner=this.querySelector(".signed-value-range-input");applySpin=()=>this.spin();applyMinusPlus=(t,e)=>this.doMinusPlus(t,e,this.isApplyMinusPlus,(()=>this.applyMinusPlus(t,Math.min(50,e+1))));isApplySpin=!1;isApplyMinusPlus=!1;timeoutID=0;signVisible=!0;min=0;max=1e9;tenMultiplier=!0;static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4SignedValueUI.html");constructor(){super(Z4SignedValueUI.UI);let t=this.querySelectorAll(".signed-value-sign-dropdown-menu img[data-type='signed-value']");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4SignedValueUI.PATH+"z4sign_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".signed-value-sign-dropdown-menu button[data-type='signed-value']");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{switch(this.querySelector(".signed-value-sign-button img[data-type='signed-value']").setAttribute("src",i.querySelector("img").getAttribute("src")),i.getAttribute("data-value")){case"positive":this.onchange(this.value.setSign(Z4Sign.POSITIVE));break;case"negative":this.onchange(this.value.setSign(Z4Sign.NEGATIVE));break;case"random":this.onchange(this.value.setSign(Z4Sign.RANDOM));break;case"alternate":this.onchange(this.value.setSign(Z4Sign.alternate()))}return null}}let i=this.getUniqueName();this.radioSpinner.id=this.getUniqueID(),this.radioSpinner.setAttribute("name",i),this.radioSpinner.onchange=t=>(this.spinner.setAttribute("min","-50"),this.spinner.setAttribute("max","50"),this.spinner.value="0",null),this.querySelector(".signed-value-radio-spinner-label").setAttribute("for",this.radioSpinner.id),this.radioRange.id=this.getUniqueID(),this.radioRange.setAttribute("name",i),this.radioRange.onchange=t=>(this.configureRange(),null),this.querySelector(".signed-value-radio-range-label").setAttribute("for",this.radioRange.id);let s=this.querySelector(".signed-value-range-minus"),n=this.querySelector(".signed-value-range-plus");Z4Loader.touch?(this.spinner.ontouchstart=t=>this.startSpin(),this.spinner.ontouchend=t=>this.stopSpin(),s.ontouchstart=t=>this.minusPlus(-1),s.ontouchend=t=>this.minusPlus(0),n.ontouchstart=t=>this.minusPlus(1),n.ontouchend=t=>this.minusPlus(0)):(this.spinner.onmousedown=t=>this.startSpin(),this.spinner.onmouseup=t=>this.stopSpin(),s.onmousedown=t=>this.minusPlus(-1),s.onmouseup=t=>this.minusPlus(0),s.onmouseleave=t=>this.minusPlus(0),n.onmousedown=t=>this.minusPlus(1),n.onmouseup=t=>this.minusPlus(0),n.onmouseleave=t=>this.minusPlus(0)),this.spinner.oninput=t=>{if(this.radioRange.checked){let t=this.getReversedValue(this.spinner.valueAsNumber);this.valueLabel.innerText=""+t,this.oninput(this.value.setValue(t))}return null},this.spinner.onchange=t=>{if(this.radioRange.checked){let t=this.getReversedValue(this.spinner.valueAsNumber);this.valueLabel.innerText=""+t,this.onchange(this.value.setValue(t))}return null},this.setValue(new Z4SignedValue)}startSpin(){return this.radioSpinner.checked&&(this.isApplySpin=!0,this.applySpin()),null}stopSpin(){return this.radioSpinner.checked&&(this.isApplySpin=!1,this.spinner.value="0",this.onchange(this.value)),null}spin(){let t=Math.max(1,Math.abs(this.spinner.valueAsNumber));this.spinner.valueAsNumber?this.doMinusPlus(this.spinner.valueAsNumber>0?1:-1,t,this.isApplySpin,this.applySpin):(clearTimeout(this.timeoutID),this.isApplySpin&&(this.timeoutID=setTimeout(this.applySpin,500/t)))}minusPlus(t){return t?(this.isApplyMinusPlus=!0,this.applyMinusPlus(t,1)):this.isApplyMinusPlus&&(this.isApplyMinusPlus=!1,clearTimeout(this.timeoutID),this.onchange(this.value)),null}doMinusPlus(t,e,i,s){let n=this.getRangedValue(this.max),a=Math.max(0,this.getRangedValue(this.value.getValue())+t);a=Math.min(a,n);let r=this.getReversedValue(a);this.valueLabel.innerText=""+r,this.radioRange.checked&&(this.spinner.value=""+a),this.oninput(this.value.setValue(r)),clearTimeout(this.timeoutID),i&&(this.timeoutID=setTimeout(s,500/e))}setRange(t,e,i){return this.min=t,this.max=e,this.tenMultiplier=i,this.querySelector(".signed-value-range-span").innerHTML="["+t+","+(1e9===e?"&infin;":e)+"]",this.radioRange.checked&&this.configureRange(),this}configureRange(){this.spinner.setAttribute("min","0"),this.spinner.setAttribute("max",""+this.getRangedValue(this.max)),this.spinner.value=""+this.getRangedValue(this.value.getValue())}getRangedValue(t){if(this.tenMultiplier){let e=0,i=this.min;for(;i<t;)e++,i<100?i++:i<1e3?i+=10:i<1e4?i+=100:i<1e5?i+=1e3:i<1e6?i+=1e4:i<1e7?i+=1e5:i<1e8?i+=1e6:i<1e9&&(i+=1e7);return e}return t}getReversedValue(t){if(this.tenMultiplier){let e=0,i=this.min;for(;e<t;)e++,i<100?i++:i<1e3?i+=10:i<1e4?i+=100:i<1e5?i+=1e3:i<1e6?i+=1e4:i<1e7?i+=1e5:i<1e8?i+=1e6:i<1e9&&(i+=1e7);return i}return t}setCompact(){return this.querySelector(".signed-value-compact-button").style.display="inline-block",this.querySelector(".signed-value-compact-dropdown-menu li").appendChild(this.querySelector(".signed-value-range-minus")),this.querySelector(".signed-value-compact-dropdown-menu li").appendChild(this.querySelector(".signed-value-form-control")),this.querySelector(".signed-value-compact-dropdown-menu li").appendChild(this.querySelector(".signed-value-range-plus")),this.querySelector(".signed-value-sign-button img").setAttribute("width","20"),this}setEnabled(t){return t?(this.querySelector(".signed-value-radio-spinner").removeAttribute("disabled"),this.querySelector(".signed-value-radio-range").removeAttribute("disabled"),this.querySelector(".signed-value-sign-button").removeAttribute("disabled"),this.querySelector(".signed-value-compact-button").removeAttribute("disabled"),this.querySelector(".signed-value-range-minus").removeAttribute("disabled"),this.querySelector(".signed-value-range-input").removeAttribute("disabled"),this.querySelector(".signed-value-range-plus").removeAttribute("disabled")):(this.querySelector(".signed-value-radio-spinner").setAttribute("disabled","disabled"),this.querySelector(".signed-value-radio-range").setAttribute("disabled","disabled"),this.querySelector(".signed-value-sign-button").setAttribute("disabled","disabled"),this.querySelector(".signed-value-compact-button").setAttribute("disabled","disabled"),this.querySelector(".signed-value-range-minus").setAttribute("disabled","disabled"),this.querySelector(".signed-value-range-input").setAttribute("disabled","disabled"),this.querySelector(".signed-value-range-plus").setAttribute("disabled","disabled")),this}setSignVisible(t){return this.signVisible=t,t?this.querySelector(".signed-value-input-group").classList.remove("sign-not-visible"):this.querySelector(".signed-value-input-group").classList.add("sign-not-visible"),this}isSignVisible(){return this.signVisible}setValueLabel(t,e,i){let s=this.querySelector(".signed-value-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setValue(t){return this.value=t,this.valueLabel.innerText=""+this.value.getValue(),this.value.getSign()===Z4Sign.POSITIVE?this.querySelector(".signed-value-sign-button img").setAttribute("src",this.querySelector(".signed-value-sign-dropdown-menu img[data-icon='positive']").getAttribute("src")):this.value.getSign()===Z4Sign.NEGATIVE?this.querySelector(".signed-value-sign-button img").setAttribute("src",this.querySelector(".signed-value-sign-dropdown-menu img[data-icon='negative']").getAttribute("src")):this.value.getSign()===Z4Sign.RANDOM?this.querySelector(".signed-value-sign-button img").setAttribute("src",this.querySelector(".signed-value-sign-dropdown-menu img[data-icon='random']").getAttribute("src")):this.querySelector(".signed-value-sign-button img").setAttribute("src",this.querySelector(".signed-value-sign-dropdown-menu img[data-icon='alternate']").getAttribute("src")),this.radioRange.checked&&this.configureRange(),this}dispose(){}}class Z4SignedRandomValueUI extends Z4AbstractComponentWithValueUI{signedValueUI=(new Z4SignedValueUI).appendToComponent(this);lengthUI=(new Z4SignedValueUI).setSignVisible(!1).setValueLabel("LENGTH",!1,!1).setRange(1,1e9,!0).appendToElement(this.querySelector(".signed-random-value-length-ui"));lengthBadge=this.querySelector(".signed-random-value-length-badge");static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4SignedRandomValueUI.html");constructor(){super(Z4SignedRandomValueUI.UI),this.signedValueUI.oninput=t=>this.oninput(this.value.setValue(t.getValue()).setSign(t.getSign())),this.signedValueUI.onchange=t=>this.onchange(this.value.setValue(t.getValue()).setSign(t.getSign())),this.signedValueUI.querySelector(".signed-value-input-group").appendChild(this.querySelector(".signed-random-value-type-button")),this.signedValueUI.querySelector(".signed-value-input-group").appendChild(this.querySelector(".signed-random-value-type-dropdown-menu"));let t=this.querySelectorAll(".signed-random-value-type-dropdown-menu img[data-type='signed-random-value']");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4SignedRandomValueUI.PATH+"z4randomvalue_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".signed-random-value-type-dropdown-menu button[data-type='signed-random-value']");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{this.querySelector(".signed-random-value-type-button img[data-type='signed-random-value']").setAttribute("src",i.querySelector("img").getAttribute("src"));let e=this.signedValueUI.getValue();switch(i.getAttribute("data-value")){case"classic":this.value=Z4SignedRandomValue.classic(e.getValue()).setSign(e.getSign());break;case"bezier":this.value=Z4SignedRandomValue.bezier(e.getValue(),this.lengthUI.getValue().getValue());break;case"polyline":this.value=Z4SignedRandomValue.polyline(e.getValue(),this.lengthUI.getValue().getValue());break;case"stepped":this.value=Z4SignedRandomValue.stepped(e.getValue(),this.lengthUI.getValue().getValue())}return this.lengthUI.setEnabled(!this.value.isClassic()),this.lengthBadge.style.display=this.value.isClassic()?"none":"inline-block",this.onchange(this.value.setSign(e.getSign())),null}}this.lengthUI.oninput=t=>{this.lengthBadge.innerText=""+t.getValue(),this.oninput(this.value.setLength(t.getValue()))},this.lengthUI.onchange=t=>{this.lengthBadge.innerText=""+t.getValue(),this.onchange(this.value.setLength(t.getValue()))},this.setValue(Z4SignedRandomValue.classic(0))}setCompact(){return this.signedValueUI.setCompact(),this.querySelector(".signed-random-value-type-button img").setAttribute("width","20"),this}setEnabled(t){return this.signedValueUI.setEnabled(t),t?this.querySelector(".signed-random-value-type-button").removeAttribute("disabled"):this.querySelector(".signed-random-value-type-button").setAttribute("disabled","disabled"),this}setRange(t,e,i){return this.signedValueUI.setRange(t,e,i),this}setSignVisible(t){return this.signedValueUI.setSignVisible(t),this}setLengthRange(t,e,i){return this.lengthUI.setRange(t,e,i),this}setValueLabel(t,e,i){return this.signedValueUI.setValueLabel(t,e,i),this}setValue(t){return this.value=t,this.signedValueUI.setValue((new Z4SignedValue).setValue(this.value.getValue()).setSign(this.value.getSign())),this.value.isClassic()?this.querySelector(".signed-random-value-type-button img").setAttribute("src",this.querySelector(".signed-random-value-type-dropdown-menu img[data-icon='classic']").getAttribute("src")):this.value.isBezier()?this.querySelector(".signed-random-value-type-button img").setAttribute("src",this.querySelector(".signed-random-value-type-dropdown-menu img[data-icon='bezier']").getAttribute("src")):this.value.isPolyline()?this.querySelector(".signed-random-value-type-button img").setAttribute("src",this.querySelector(".signed-random-value-type-dropdown-menu img[data-icon='polyline']").getAttribute("src")):this.value.isStepped()&&this.querySelector(".signed-random-value-type-button img").setAttribute("src",this.querySelector(".signed-random-value-type-dropdown-menu img[data-icon='stepped']").getAttribute("src")),this.lengthUI.setEnabled(!this.value.isClassic()),this.lengthUI.setValue((new Z4SignedValue).setValue(this.value.getLength())),this.lengthBadge.style.display=this.value.isClassic()?"none":"inline-block",this.lengthBadge.innerText=""+this.value.getLength(),this}dispose(){}}class Z4FancifulValueUI extends Z4AbstractComponentWithValueUI{uniformCheck=this.querySelector(".fanciful-value-uniform-check");constantUI=(new Z4SignedValueUI).setCompact().setValueLabel("CONSTANT",!1,!0).appendToElement(this.querySelector(".fanciful-value-container"));randomUI=(new Z4SignedRandomValueUI).setCompact().setValueLabel("RANDOM",!1,!0).appendToElement(this.querySelector(".fanciful-value-container"));static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4FancifulValueUI.html");constructor(){super(Z4FancifulValueUI.UI),this.uniformCheck.id=this.getUniqueID(),this.querySelector(".fanciful-value-uniform-label").setAttribute("for",this.uniformCheck.id),this.uniformCheck.onchange=t=>(this.setSignsVisible(this.constantUI.isSignVisible()),this.onchange(this.value.setUniformSign(this.uniformCheck.checked)),null);let t=document.createElement("li");t.className="dropdown-divider";let e=document.createElement("li");e.appendChild(t),this.querySelector(".signed-value-sign-dropdown-menu").appendChild(e),e=document.createElement("li"),e.className="mx-1",e.appendChild(this.querySelector(".fanciful-value-uniform-form-switch")),this.querySelector(".signed-value-sign-dropdown-menu").appendChild(e),this.constantUI.oninput=t=>this.onInput(),this.randomUI.oninput=t=>this.onInput(),this.constantUI.onchange=t=>this.onChange(),this.randomUI.onchange=t=>this.onChange(),this.setValue(new Z4FancifulValue)}onInput(){return this.oninput(this.value.setConstant(this.constantUI.getValue()).setRandom(this.randomUI.getValue())),null}onChange(){return this.onchange(this.value.setConstant(this.constantUI.getValue()).setRandom(this.randomUI.getValue())),null}setEnabled(t){return this.constantUI.setEnabled(t),this.randomUI.setEnabled(t),this}setSignsVisible(t){return this.constantUI.setSignVisible(t),this.constantUI.setValueLabel(t?"CONSTANT":"CONSTANT_SHORT",!1,!0),this.randomUI.setSignVisible(!this.uniformCheck.checked&&t),this.randomUI.setValueLabel(!this.uniformCheck.checked&&t?"RANDOM":"RANDOM_SHORT",!1,!0),this}setConstantRange(t,e,i){return this.constantUI.setRange(t,e,i),this}setRandomRange(t,e,i){return this.randomUI.setRange(t,e,i),this}setRandomLengthRange(t,e,i){return this.randomUI.setLengthRange(t,e,i),this}setValueLabel(t,e,i){let s=this.querySelector(".fanciful-value-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setValue(t){return this.value=t,this.uniformCheck.checked=this.value.isUniformSign(),this.setSignsVisible(this.constantUI.isSignVisible()),this.constantUI.setValue(this.value.getConstant()),this.randomUI.setValue(this.value.getRandom()),this}dispose(){}}class Z4RotationUI extends Z4AbstractComponentWithValueUI{startAngle=(new Z4SignedValueUI).setCompact().setRange(0,360,!1).setValueLabel("START_ANGLE",!0,!1).setSignVisible(!1).insertBeforeElement(this.querySelector(".rotation-type-button"));delayedCheck=this.querySelector(".rotation-delayed-check");angle=(new Z4FancifulValueUI).setValueLabel("ANGLE",!0,!1).setConstantRange(0,180,!1).setRandomRange(0,180,!1).insertBeforeElement(this.querySelector(".rotation-type-button"));static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4RotationUI.html");constructor(){super(Z4RotationUI.UI);let t=this.querySelectorAll(".rotation-type-dropdown-menu img[data-type='rotation']");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4RotationUI.PATH+"z4rotation_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".rotation-type-dropdown-menu button[data-type='rotation']");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{switch(this.querySelector(".rotation-type-button img[data-type='rotation']").setAttribute("src",i.querySelector("img").getAttribute("src")),i.getAttribute("data-value")){case"fixed":this.value=Z4Rotation.fixed();break;case"cumulative":this.value=Z4Rotation.cumulative();break;case"relativetopath":this.value=Z4Rotation.relativeToPath()}return this.onchange(this.value.setAngle(this.angle.getValue()).setStartAngle(this.startAngle.getValue().getValue()).setDelayed(this.delayedCheck.checked)),null}}this.delayedCheck.id=this.getUniqueID(),this.querySelector(".rotation-delayed-label").setAttribute("for",this.delayedCheck.id),this.delayedCheck.onchange=t=>(this.querySelector(".rotation-delayed-badge").style.display=this.delayedCheck.checked?"inline-block":"none",this.onchange(this.value.setDelayed(this.delayedCheck.checked)),null),this.startAngle.querySelector(".signed-value-value-label").style.display="block";let i=this.startAngle.querySelector(".signed-value-compact-button"),s=document.createElement("span");for(let t=0;t<10;t++)s.innerHTML+="&nbsp";i.appendChild(s),this.startAngle.oninput=t=>this.oninput(this.value.setStartAngle(t.getValue())),this.startAngle.onchange=t=>this.onchange(this.value.setStartAngle(t.getValue())),this.angle.oninput=t=>this.oninput(this.value.setAngle(t)),this.angle.onchange=t=>this.onchange(this.value.setAngle(t)),this.setValue(Z4Rotation.fixed())}setRandomLengthRange(t,e,i){return this.angle.setRandomLengthRange(t,e,i),this}setValueLabel(t,e,i){let s=this.querySelector(".rotation-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setValue(t){return this.value=t,this.value.isFixed()?this.querySelector(".rotation-type-button img").setAttribute("src",this.querySelector(".rotation-type-dropdown-menu img[data-icon='fixed']").getAttribute("src")):this.value.isCumulative()?this.querySelector(".rotation-type-button img").setAttribute("src",this.querySelector(".rotation-type-dropdown-menu img[data-icon='cumulative']").getAttribute("src")):this.value.isRelativeToPath()&&this.querySelector(".rotation-type-button img").setAttribute("src",this.querySelector(".rotation-type-dropdown-menu img[data-icon='relativetopath']").getAttribute("src")),this.delayedCheck.checked=this.value.isDelayed(),this.querySelector(".rotation-delayed-badge").style.display=this.value.isDelayed()?"inline-block":"none",this.startAngle.setValue((new Z4SignedValue).setValue(this.value.getStartAngle())),this.angle.setValue(this.value.getAngle()),this}dispose(){}}class Z4Lighting{static NONE=new Z4Lighting;static LIGHTED=new Z4Lighting;static DARKENED=new Z4Lighting;constructor(){}}class Z4Progression{type=0;temporalStepProgression=.1;lighting=Z4Lighting.NONE;constructor(t,e,i){this.temporalStepProgression=t,this.lighting=e,this.type=i}isSpatial(){return 0===this.type}isTemporal(){return 1===this.type}isRelativeToPath(){return 2===this.type}isRandom(){return 3===this.type}setTemporalStepProgression(t){return this.temporalStepProgression=t,this}getTemporalStepProgression(){return this.temporalStepProgression}setLighting(t){return this.lighting=t,this}getLighting(){return this.lighting}next(t){if(this.isTemporal()){t.setLighting(this.lighting),t.setDrawBounds(!1);let e=t.getColorPosition();e=-1===e?0:e+this.temporalStepProgression,e>1&&(e-=1),t.setColorPosition(e)}else this.isSpatial()?(t.setLighting(Z4Lighting.NONE),t.setDrawBounds(!1),t.setColorPosition(-1)):this.isRelativeToPath()?(t.setLighting(this.lighting),t.setDrawBounds(!0),t.setColorPosition(-1)):this.isRandom()&&(t.setLighting(this.lighting),t.setDrawBounds(!1),t.setColorPosition(Math.random()))}static spatial(t){return new Z4Progression(0,t,0)}static temporal(t,e){return new Z4Progression(t,e,1)}static relativeToPath(t){return new Z4Progression(0,t,2)}static random(t){return new Z4Progression(0,t,3)}}class Z4Color{a=0;r=0;g=0;b=0;argb=0;hex=null;constructor(t,e,i,s){this.a=t,this.r=e,this.g=i,this.b=s,this.init()}init(){return this.argb=this.a<<24|this.r<<16|this.g<<8|this.b,this.hex="#"+new Number(this.r).toString(16).padStart(2,"0")+new Number(this.g).toString(16).padStart(2,"0")+new Number(this.b).toString(16).padStart(2,"0")+new Number(this.a).toString(16).padStart(2,"0"),this}set(t){return this.a=t>>>24&255,this.r=t>>>16&255,this.g=t>>>8&255,this.b=255&t,this.init()}gray(){let t=parseInt(.21*this.r+.71*this.g+.08*this.b);return this.r=t,this.g=t,this.b=t,this.init()}negative(){return this.r=255-this.r,this.g=255-this.g,this.b=255-this.b,this.init()}lighted(t){return this.r=parseInt((255-this.r)*t+this.r),this.g=parseInt((255-this.g)*t+this.g),this.b=parseInt((255-this.b)*t+this.b),this.init()}darkened(t){return t=1-t,this.r=parseInt(t*this.r),this.g=parseInt(t*this.g),this.b=parseInt(t*this.b),this.init()}getComponents(){return new Array(this.a,this.r,this.g,this.b)}getARGB(){return this.argb}getHEX(){return this.hex}static fromARGB(t){return new Z4Color(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}static fromHEX(t,e){let i=new RegExp("^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$","i").exec(t);return new Z4Color(e,parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16))}static getFillStyle(t){return t}static fromZ4Colors(t,e,i){let s=t.getComponents(),n=e.getComponents();return new Z4Color(parseInt((n[0]-s[0])*i+s[0]),parseInt((n[1]-s[1])*i+s[1]),parseInt((n[2]-s[2])*i+s[2]),parseInt((n[3]-s[3])*i+s[3]))}}class Z4GradientColor{start=new Z4Color(255,255,255,255);stop=new Z4Color(255,0,0,0);ripple=0;mirrored=!1;setStartColor(t){return this.start.set(t),this}getStartColor(){return this.start}setStopColor(t){return this.stop.set(t),this}getStopColor(){return this.stop}setRipple(t){return this.ripple=t,this}getRipple(){return this.ripple}setMirrored(t){return this.mirrored=t,this}isMirrored(){return this.mirrored}negative(){return this.start.negative(),this.stop.negative(),this}inverted(){let t=this.start.getARGB();return this.start.set(this.stop.getARGB()),this.stop.set(t),this}getZ4ColorAt(t,e,i){return i&&this.mirrored&&(t=2*(t<.5?t:1-t)),e&&0!==this.ripple&&(t=Z4Math.ripple(t,0,1,this.ripple)),Z4Color.fromZ4Colors(this.start,this.stop,t)}getLinearGradient(t,e,i,s,n){let a=t.createLinearGradient(e,i,s,n);return a.addColorStop(0,this.start.getHEX()),a.addColorStop(1,this.stop.getHEX()),a}getRadialGradient(t,e,i,s,n,a,r){let o=t.createRadialGradient(e,i,s,n,a,r);return o.addColorStop(0,this.start.getHEX()),o.addColorStop(1,this.stop.getHEX()),o}getConicGradient(t,e,i,s){let n=t.createConicGradient(s,e,i);return n.addColorStop(0,this.start.getHEX()),n.addColorStop(1,this.stop.getHEX()),n}static fromZ4GradientColors(t,e,i){return(new Z4GradientColor).setStartColor(Z4Color.fromZ4Colors(t.getStartColor(),e.getStartColor(),i).getARGB()).setStopColor(Z4Color.fromZ4Colors(t.getStopColor(),e.getStopColor(),i).getARGB()).setRipple(t.getRipple()).setMirrored(t.isMirrored())}static fromStartStopZ4GradientColors(t,e,i){return(new Z4GradientColor).setStartColor(t.getZ4ColorAt(i,!1,!1).getARGB()).setStopColor(e.getZ4ColorAt(i,!1,!1).getARGB()).setRipple(t.getRipple()).setMirrored(t.isMirrored())}}class Z4ProgressionUI extends Z4AbstractComponentWithValueUI{stepLabel=this.querySelector(".progression-step-range-label");stepRange=this.querySelector(".progression-step-range");stepBadge=this.querySelector(".progression-step-badge");static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4ProgressionUI.html");constructor(){super(Z4ProgressionUI.UI);let t=this.querySelectorAll(".progression-type-dropdown-menu img[data-type='progression']");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4ProgressionUI.PATH+"z4progression_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".progression-type-dropdown-menu button[data-type='progression']");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{switch(this.querySelector(".progression-type-button img[data-type='progression']").setAttribute("src",i.querySelector("img").getAttribute("src")),i.getAttribute("data-value")){case"spatial":this.value=Z4Progression.spatial(this.value.getLighting());break;case"temporal":this.value=Z4Progression.temporal(this.value.getTemporalStepProgression(),this.value.getLighting());break;case"relativetopath":this.value=Z4Progression.relativeToPath(this.value.getLighting());break;case"random":this.value=Z4Progression.random(this.value.getLighting())}return this.value.isTemporal()?this.stepRange.removeAttribute("disabled"):this.stepRange.setAttribute("disabled","disabled"),this.stepBadge.style.display=this.value.isTemporal()?"inline-block":"none",this.onchange(this.value),null}}this.stepRange.oninput=t=>(this.stepLabel.innerText=this.stepRange.value,this.stepBadge.innerText=this.stepRange.value,this.oninput(this.value.setTemporalStepProgression(this.stepRange.valueAsNumber)),null),this.stepRange.onchange=t=>(this.stepLabel.innerText=this.stepRange.value,this.stepBadge.innerText=this.stepRange.value,this.onchange(this.value.setTemporalStepProgression(this.stepRange.valueAsNumber)),null),t=this.querySelectorAll(".progression-lighting-dropdown-menu img[data-type='lighting']");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4ProgressionUI.PATH+"z4lighting_"+i.getAttribute("data-icon")+".svg")}e=this.querySelectorAll(".progression-lighting-dropdown-menu button[data-type='lighting']");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{switch(this.querySelector(".progression-lighting-button img[data-type='lighting']").setAttribute("src",i.querySelector("img").getAttribute("src")),i.getAttribute("data-value")){case"none":this.onchange(this.value.setLighting(Z4Lighting.NONE));break;case"lighted":this.onchange(this.value.setLighting(Z4Lighting.LIGHTED));break;case"darkened":this.onchange(this.value.setLighting(Z4Lighting.DARKENED))}return null}}this.setValue(Z4Progression.spatial(Z4Lighting.NONE))}setProgressionLabel(t,e,i){let s=this.querySelector(".progression-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setValue(t){return this.value=t,this.value.isSpatial()?this.querySelector(".progression-type-button img").setAttribute("src",this.querySelector(".progression-type-dropdown-menu img[data-icon='spatial']").getAttribute("src")):this.value.isTemporal()?this.querySelector(".progression-type-button img").setAttribute("src",this.querySelector(".progression-type-dropdown-menu img[data-icon='temporal']").getAttribute("src")):this.value.isRelativeToPath()?this.querySelector(".progression-type-button img").setAttribute("src",this.querySelector(".progression-type-dropdown-menu img[data-icon='relativetopath']").getAttribute("src")):this.value.isRandom()&&this.querySelector(".progression-type-button img").setAttribute("src",this.querySelector(".progression-type-dropdown-menu img[data-icon='random']").getAttribute("src")),this.stepRange.valueAsNumber=this.value.getTemporalStepProgression(),this.stepLabel.innerText=this.stepRange.value,this.value.isTemporal()?this.stepRange.removeAttribute("disabled"):this.stepRange.setAttribute("disabled","disabled"),this.stepBadge.style.display=this.value.isTemporal()?"inline-block":"none",this.stepBadge.innerText=""+this.value.getTemporalStepProgression(),this.value.getLighting()===Z4Lighting.NONE?this.querySelector(".progression-lighting-button img").setAttribute("src",this.querySelector(".progression-lighting-dropdown-menu img[data-icon='none']").getAttribute("src")):this.value.getLighting()===Z4Lighting.LIGHTED?this.querySelector(".progression-lighting-button img").setAttribute("src",this.querySelector(".progression-lighting-dropdown-menu img[data-icon='lighted']").getAttribute("src")):this.value.getLighting()===Z4Lighting.DARKENED&&this.querySelector(".progression-lighting-button img").setAttribute("src",this.querySelector(".progression-lighting-dropdown-menu img[data-icon='darkened']").getAttribute("src")),this}dispose(){}}class Z4ColorUI extends Z4AbstractComponentWithValueUI{color=this.querySelector(".color-input");opacityLabel=this.querySelector(".color-opacity-range-label");opacityRange=this.querySelector(".color-opacity-range");opacityBadge=this.querySelector(".color-opacity-badge");static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4ColorUI.html");constructor(){super(Z4ColorUI.UI),this.querySelector(".color-gray").onclick=t=>(this.setValue(this.value.gray()),this.onchange(this.value),null),this.querySelector(".color-negative").onclick=t=>(this.setValue(this.value.negative()),this.onchange(this.value),null),this.color.oninput=t=>(this.value=Z4Color.fromHEX(this.color.value,this.opacityRange.valueAsNumber),this.oninput(this.value),null),this.color.onchange=t=>(this.value=Z4Color.fromHEX(this.color.value,this.opacityRange.valueAsNumber),this.onchange(this.value),null),this.opacityRange.oninput=t=>(this.opacityLabel.innerText=this.opacityRange.value,this.opacityBadge.innerText=this.opacityRange.value,this.value=Z4Color.fromHEX(this.color.value,this.opacityRange.valueAsNumber),this.oninput(this.value),null),this.opacityRange.onchange=t=>(this.opacityLabel.innerText=this.opacityRange.value,this.opacityBadge.innerText=this.opacityRange.value,this.value=Z4Color.fromHEX(this.color.value,this.opacityRange.valueAsNumber),this.onchange(this.value),null),this.setValue(new Z4Color(255,0,0,0))}setColorLabel(t,e,i){let s=this.querySelector(".color-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setOpacityBadgeVisible(t){return this.opacityBadge.style.display=t?"inline-block":"none",this}setValue(t){return this.value=t,this.color.value=this.value.getHEX().substring(0,7),this.opacityRange.valueAsNumber=this.value.getComponents()[0],this.opacityLabel.innerText=this.opacityRange.value,this.opacityBadge.innerText=this.opacityRange.value,this}dispose(){}}class Z4GradientColorUI extends Z4AbstractComponentWithValueUI{startColorUI=(new Z4ColorUI).setColorLabel("START",!1,!0).setOpacityBadgeVisible(!1).appendToElement(this.querySelector(".gradient-color-start-container"));canvas=this.querySelector(".gradient-color-canvas");stopColorUI=(new Z4ColorUI).setColorLabel("STOP",!1,!0).setOpacityBadgeVisible(!1).appendToElement(this.querySelector(".gradient-color-stop-container"));ctx=this.canvas.getContext("2d");chessboard=this.ctx.createPattern(Z4ImageFactory.get("CHESSBOARD"),"repeat");mirroredCheck=this.querySelector(".gradient-color-mirrored-check");rippleLabel=this.querySelector(".gradient-color-ripple-label");rippleRange=this.querySelector(".gradient-color-ripple-range");resizeObserver=new ResizeObserver((()=>this.drawCanvas()));horizontal=!0;static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4GradientColorUI.html");constructor(){super(Z4GradientColorUI.UI),this.initDevicePixelRatio((()=>this.drawCanvas())),this.resizeObserver.observe(this.canvas),this.querySelector(".gradient-color-inverted").onclick=t=>(this.setValue(this.value.inverted()),this.onchange(this.value),null),this.querySelector(".gradient-color-negative").onclick=t=>(this.setValue(this.value.negative()),this.onchange(this.value),null),this.mirroredCheck.id=this.getUniqueID(),this.querySelector(".gradient-color-mirrored-label").setAttribute("for",this.mirroredCheck.id),this.mirroredCheck.onchange=t=>(this.onchange(this.value.setMirrored(this.mirroredCheck.checked)),this.drawCanvas(),null),this.rippleRange.oninput=t=>(this.rippleLabel.innerText=this.rippleRange.value,this.oninput(this.value.setRipple(this.rippleRange.valueAsNumber)),this.drawCanvas(),null),this.rippleRange.onchange=t=>(this.rippleLabel.innerText=this.rippleRange.value,this.onchange(this.value.setRipple(this.rippleRange.valueAsNumber)),this.drawCanvas(),null),this.startColorUI.oninput=t=>{this.oninput(this.value.setStartColor(t.getARGB())),this.drawCanvas()},this.startColorUI.onchange=t=>{this.onchange(this.value.setStartColor(t.getARGB())),this.drawCanvas()},this.stopColorUI.oninput=t=>{this.oninput(this.value.setStopColor(t.getARGB())),this.drawCanvas()},this.stopColorUI.onchange=t=>{this.onchange(this.value.setStopColor(t.getARGB())),this.drawCanvas()},this.setValue(new Z4GradientColor)}setVertical(){this.horizontal=!1;let t=this.querySelector(".gradient-color-container");t.parentElement.style.height="100%",t.style.flexDirection="column",t.style.alignItems="start",t.style.height="calc(100% - 24px)",this.startColorUI.querySelector(".input-group").classList.add("dropend"),this.stopColorUI.querySelector(".input-group").classList.add("dropend"),this.querySelector(".gradient-color-input-group-canvas").style.flexDirection="column",this.querySelector(".gradient-color-input-group-canvas").classList.add("dropend"),this.canvas.removeAttribute("height"),this.canvas.style.removeProperty("height"),this.canvas.width=71.8,this.canvas.style.width="71.8px",this.canvas.style.borderTopRightRadius="0.25rem",this.canvas.style.borderBottomLeftRadius="0";let e=this.querySelector(".gradient-color-canvas-button");return e.style.width="71.8px",e.style.marginLeft="0.25px",e.style.borderTopRightRadius="0",e.style.borderBottomLeftRadius="0.25rem",this}setGradientColorLabel(t,e,i){let s=this.querySelector(".gradient-color-label");return s.setAttribute("data-token-lang-inner_text",t),s.innerHTML=Z4MessageFactory.get(t),s.style.fontWeight=e?"700":"400",s.style.fontStyle=i?"italic":"normal",this}setValue(t){return this.value=t,this.mirroredCheck.checked=this.value.isMirrored(),this.rippleRange.valueAsNumber=this.value.getRipple(),this.rippleLabel.innerText=this.rippleRange.value,this.startColorUI.setValue(this.value.getStartColor()),this.stopColorUI.setValue(this.value.getStopColor()),this.drawCanvas(),this}drawCanvas(){if(this.canvas.clientWidth){this.canvas.width=Math.floor(this.canvas.clientWidth*window.devicePixelRatio),this.canvas.height=Math.floor(this.canvas.clientHeight*window.devicePixelRatio);let t=new OffscreenCanvas(this.canvas.clientWidth,this.canvas.clientHeight),e=t.getContext("2d");if(this.horizontal)for(let t=0;t<this.canvas.clientWidth;t++)e.fillStyle=this.value.getZ4ColorAt(t/this.canvas.clientWidth,!0,!0).getHEX(),e.fillRect(t,0,1,this.canvas.clientHeight);else for(let t=0;t<this.canvas.clientHeight;t++)e.fillStyle=this.value.getZ4ColorAt(t/this.canvas.clientHeight,!0,!0).getHEX(),e.fillRect(0,t,this.canvas.clientWidth,1);this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.fillStyle=this.chessboard,this.ctx.fillRect(0,0,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.drawImage(t,0,0),this.ctx.restore()}}dispose(){this.disposeDevicePixelRatio(),this.resizeObserver.unobserve(this.canvas)}}class Z4Painter{draw(t,e,i){}getColor(t){return t}}class Z4ArrowPainter extends Z4Painter{bool=!1;draw(t,e,i){this.bool=!this.bool;let s=e.getIntensity()*e.getZ4Vector().getModule();return t.save(),t.lineWidth=1,t.strokeStyle=this.getColor(document.body.classList.contains("z4-dark")?"white":"black"),t.beginPath(),t.arc(0,0,2,0,Z4Math.TWO_PI),t.stroke(),t.strokeStyle=this.getColor(this.bool?"blue":"red"),t.beginPath(),t.moveTo(0,0),t.lineTo(s,0),t.lineTo(s-5,-2.5),t.lineTo(s-5,2.5),t.lineTo(s,0),t.stroke(),t.restore(),this}}class Z4ClassicPainter extends Z4Painter{draw(t,e,i){return this}}class Z4Shape2DPainter extends Z4Painter{shape=Z4Shape2D.SQUARE;width=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(50).setSign(Z4Sign.POSITIVE));height=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(50).setSign(Z4Sign.POSITIVE));regular=!1;shadowShiftX=new Z4FancifulValue;shadowShiftY=new Z4FancifulValue;shadowColor=new Z4Color(255,0,0,0);borderWidth=new Z4FancifulValue;borderHeight=new Z4FancifulValue;borderColor=new Z4Color(255,0,0,0);setShape2D(t){return this.shape=t,this}getShape(){return this.shape}setSize(t,e,i){return this.width=t,this.height=e,this.regular=i,this}getWidth(){return this.width}getHeight(){return this.height}isRegular(){return this.regular}setShadow(t,e,i){return this.shadowShiftX=t,this.shadowShiftY=e,this.shadowColor=i,this}getShadowShiftX(){return this.shadowShiftX}getShadowShiftY(){return this.shadowShiftY}getShadowColor(){return this.shadowColor}setBorder(t,e,i){return this.borderWidth=t,this.borderHeight=e,this.borderColor=i,this}getBorderWidth(){return this.borderWidth}getBorderHeight(){return this.borderHeight}getBorderColor(){return this.borderColor}draw(t,e,i){if(e.isDrawBounds()){let i=e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.width.getConstant().getValue()),s=this.regular?i:e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.height.getConstant().getValue());this.drawBounds(t,i,s)}else{let s=e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.width.next()),n=this.regular?s:e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.height.next());if(s<=0||n<=0)return this;let a=e.getIntensity()*this.shadowShiftX.next(),r=e.getIntensity()*this.shadowShiftY.next(),o=e.getIntensity()*this.borderWidth.next(),l=e.getIntensity()*this.borderHeight.next();(a>0||r>0)&&(t.save(),t.translate(a,r),this.drawPath(t,s+(o>0?o:0),n+(l>0?l:0),this.shadowColor),t.restore()),(o>0||l>0)&&(t.save(),this.drawPath(t,s+o,n+l,this.borderColor),t.restore());let h=e.getColorPosition(),u=e.getLighting();if(-1===h){let e=Math.max(s,n);for(let a=e;a>0;a--)this.drawPath(t,s*a/e,n*a/e,i.getZ4ColorAt(a/e,!0,!0))}else if(u===Z4Lighting.NONE)this.drawPath(t,s,n,i.getZ4ColorAt(h,!0,!0));else{let e=Math.max(s,n),a=i.getZ4ColorAt(h,!0,!0);for(let i=e;i>0;i--)u===Z4Lighting.LIGHTED?this.drawPath(t,s*i/e,n*i/e,Z4Color.fromARGB(a.getARGB()).lighted(i/e)):u===Z4Lighting.DARKENED&&this.drawPath(t,s*i/e,n*i/e,Z4Color.fromARGB(a.getARGB()).darkened(i/e))}}return this}drawPath(t,e,i,s){t.save(),t.scale(e,i),t.fillStyle=s.getHEX(),t.fill(this.shape.getPath()),t.restore()}drawBounds(t,e,i){t.save(),t.scale(e,i),t.lineWidth=1/Math.min(e,i),t.strokeStyle=this.getColor("gray"),t.stroke(this.shape.getPath()),t.strokeStyle=this.getColor("black"),t.translate(1/e,1/i),t.stroke(this.shape.getPath()),t.restore()}}class Z4NaturalFigurePainter extends Z4Painter{draw(t,e,i){return this}}class Z4CenteredFigurePainter extends Z4Painter{draw(t,e,i){return this}}class Z4Shape2DPainterUI extends Z4AbstractComponentWithValueUI{canvas=this.querySelector(".shape2d-painter-canvas");ctx=this.canvas.getContext("2d");width=(new Z4FancifulValueUI).setValueLabel("WIDTH",!0,!0).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-first-row"));height=(new Z4FancifulValueUI).setValueLabel("HEIGHT",!0,!0).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-first-row"));regularCheck=this.querySelector(".shape2d-painter-regular-check");shadowShiftX=(new Z4FancifulValueUI).setValueLabel("DELTA_X",!0,!1).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-second-row"));shadowShiftY=(new Z4FancifulValueUI).setValueLabel("DELTA_Y",!0,!1).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-second-row"));shadowColor=(new Z4ColorUI).setColorLabel("COLOR",!0,!1).appendToElement(this.querySelector(".shape2d-painter-container-second-row"));borderWidth=(new Z4FancifulValueUI).setValueLabel("WIDTH",!0,!1).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-third-row"));borderHeight=(new Z4FancifulValueUI).setValueLabel("HEIGHT",!0,!1).setConstantRange(0,100,!1).setRandomRange(0,100,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".shape2d-painter-container-third-row"));borderColor=(new Z4ColorUI).setColorLabel("COLOR",!0,!1).appendToElement(this.querySelector(".shape2d-painter-container-third-row"));pointIterator=new Z4Stamper;resizeObserver=new ResizeObserver((()=>this.drawCanvas()));mutationObserver=new MutationObserver((()=>this.drawCanvas()));static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/painter/ui/Z4Shape2DPainterUI.html");constructor(){super(Z4Shape2DPainterUI.UI),this.initDevicePixelRatio((()=>this.drawCanvas())),this.resizeObserver.observe(this.canvas);let t=new Object;t.attributeFilter=new Array("class"),this.mutationObserver.observe(document.body,t);let e=this.querySelectorAll(".shape2d-painter-shape-dropdown-menu img[data-type='shape']");for(let t=0;t<e.length;t++){let i=e.item(t);i.setAttribute("src",Z4Shape2DPainterUI.PATH+"z4shape2d_"+i.getAttribute("data-icon")+".svg")}let i=this.querySelectorAll(".shape2d-painter-shape-dropdown-menu button[data-type='shape']");for(let t=0;t<i.length;t++){let e=i.item(t);e.onclick=t=>{switch(this.querySelector(".shape2d-painter-shape-button img[data-type='shape']").setAttribute("src",e.querySelector("img").getAttribute("src")),e.getAttribute("data-value")){case"circle":this.onchange(this.value.setShape2D(Z4Shape2D.CIRCLE));break;case"triangle":this.onchange(this.value.setShape2D(Z4Shape2D.TRIANGLE));break;case"square":this.onchange(this.value.setShape2D(Z4Shape2D.SQUARE));break;case"diamond":this.onchange(this.value.setShape2D(Z4Shape2D.DIAMOND));break;case"pentagon":this.onchange(this.value.setShape2D(Z4Shape2D.PENTAGON));break;case"hexagon":this.onchange(this.value.setShape2D(Z4Shape2D.HEXAGON));break;case"septagon":this.onchange(this.value.setShape2D(Z4Shape2D.SEPTAGON));break;case"heptagon":this.onchange(this.value.setShape2D(Z4Shape2D.HEPTAGON));break;case"star":this.onchange(this.value.setShape2D(Z4Shape2D.STAR))}return this.drawCanvas(),null}}this.regularCheck.id=this.getUniqueID(),this.querySelector(".shape2d-painter-regular-label").setAttribute("for",this.regularCheck.id),this.regularCheck.onchange=t=>(this.setSize(!0),null),this.width.oninput=t=>this.setSize(!1),this.width.onchange=t=>this.setSize(!0),this.height.oninput=t=>this.setSize(!1),this.height.onchange=t=>this.setSize(!0),this.shadowShiftX.oninput=t=>this.setShadow(!1),this.shadowShiftX.onchange=t=>this.setShadow(!0),this.shadowShiftY.oninput=t=>this.setShadow(!1),this.shadowShiftY.onchange=t=>this.setShadow(!0),this.shadowColor.oninput=t=>this.setShadow(!1),this.shadowColor.onchange=t=>this.setShadow(!0),this.borderWidth.oninput=t=>this.setBorder(!1),this.borderWidth.onchange=t=>this.setBorder(!0),this.borderHeight.oninput=t=>this.setBorder(!1),this.borderHeight.onchange=t=>this.setBorder(!0),this.borderColor.oninput=t=>this.setBorder(!1),this.borderColor.onchange=t=>this.setBorder(!0),this.setValue(new Z4Shape2DPainter)}setSize(t){t?this.onchange(this.value.setSize(this.width.getValue(),this.height.getValue(),this.regularCheck.checked)):this.oninput(this.value.setSize(this.width.getValue(),this.height.getValue(),this.regularCheck.checked)),this.height.setEnabled(!this.regularCheck.checked),this.drawCanvas()}setShadow(t){t?this.onchange(this.value.setShadow(this.shadowShiftX.getValue(),this.shadowShiftY.getValue(),this.shadowColor.getValue())):this.oninput(this.value.setShadow(this.shadowShiftX.getValue(),this.shadowShiftY.getValue(),this.shadowColor.getValue())),this.drawCanvas()}setBorder(t){t?this.onchange(this.value.setBorder(this.borderWidth.getValue(),this.borderHeight.getValue(),this.borderColor.getValue())):this.oninput(this.value.setBorder(this.borderWidth.getValue(),this.borderHeight.getValue(),this.borderColor.getValue())),this.drawCanvas()}setPointIterator(t){return this.pointIterator=t,this}setValue(t){return this.value=t,this.value.getShape()===Z4Shape2D.CIRCLE?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='circle']").getAttribute("src")):this.value.getShape()===Z4Shape2D.TRIANGLE?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='triangle']").getAttribute("src")):this.value.getShape()===Z4Shape2D.SQUARE?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='square']").getAttribute("src")):this.value.getShape()===Z4Shape2D.DIAMOND?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='diamond']").getAttribute("src")):this.value.getShape()===Z4Shape2D.PENTAGON?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='pentagon']").getAttribute("src")):this.value.getShape()===Z4Shape2D.HEXAGON?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='hexagon']").getAttribute("src")):this.value.getShape()===Z4Shape2D.SEPTAGON?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='septagon']").getAttribute("src")):this.value.getShape()===Z4Shape2D.HEPTAGON?this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='heptagon']").getAttribute("src")):this.value.getShape()===Z4Shape2D.STAR&&this.querySelector(".shape2d-painter-shape-button img").setAttribute("src",this.querySelector(".shape2d-painter-shape-dropdown-menu img[data-icon='star']").getAttribute("src")),this.regularCheck.checked=this.value.isRegular(),this.width.setValue(this.value.getWidth()),this.height.setValue(this.value.getHeight()),this.height.setEnabled(!this.regularCheck.checked),this.shadowShiftX.setValue(this.value.getShadowShiftX()),this.shadowShiftY.setValue(this.value.getShadowShiftY()),this.shadowColor.setValue(this.value.getShadowColor()),this.borderWidth.setValue(this.value.getBorderWidth()),this.borderHeight.setValue(this.value.getBorderHeight()),this.borderColor.setValue(this.value.getBorderColor()),this.drawCanvas(),this}drawCanvas(){if(this.canvas.clientWidth){this.canvas.width=Math.floor(this.canvas.clientWidth*window.devicePixelRatio),this.canvas.height=Math.floor(this.canvas.clientHeight*window.devicePixelRatio);let t=new OffscreenCanvas(this.canvas.clientWidth,this.canvas.clientHeight),e=t.getContext("2d");this.pointIterator.drawDemo(e,this.value,null,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.drawImage(t,0,0),this.ctx.restore()}}dispose(){this.disposeDevicePixelRatio(),this.resizeObserver.unobserve(this.canvas),this.mutationObserver.unobserve(document.body)}}class Z4Action{static START=new Z4Action;static CONTINUE=new Z4Action;static STOP=new Z4Action;constructor(){}}class Z4PointIterator{progression=Z4Progression.spatial(Z4Lighting.NONE);rotation=Z4Rotation.fixed();z4Point=new Z4Point;P=new Object;hasNext=!1;constructor(){this.P.x=0,this.P.y=0}setProgression(t){return this.progression=t,this}getProgression(){return this.progression}setRotation(t){return this.rotation=t,this}getRotation(){return this.rotation}draw(t,e,i){}next(){}drawDemo(t,e,i,s,n){}}class Z4Stamper extends Z4PointIterator{intensity=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(1).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));multiplicity=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(1).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));push=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(0).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));currentMultiplicityCounter=0;currentMultiplicityTotal=0;draw(t,e,i){return t===Z4Action.START&&(this.currentMultiplicityCounter=0,this.currentMultiplicityTotal=parseInt(this.multiplicity.next()),this.P.x=e,this.P.y=i,this.hasNext=!0,!0)}next(){if(this.hasNext){this.currentMultiplicityCounter++,this.hasNext=this.currentMultiplicityCounter<this.currentMultiplicityTotal;let t=this.rotation.next(0),e=this.push.next();if(e){let i=Z4Vector.fromVector(this.P.x,this.P.y,e,t);this.z4Point.setZ4Vector(Z4Vector.fromVector(i.getX(),i.getY(),1,t))}else this.z4Point.setZ4Vector(Z4Vector.fromVector(this.P.x,this.P.y,1,t));return this.rotation.nextSide(this.z4Point,null),this.progression.next(this.z4Point),this.progression.isRelativeToPath()&&(this.z4Point.setDrawBounds(!1),this.z4Point.setColorPosition(Math.random())),this.z4Point.setIntensity(this.intensity.next())}return null}drawDemo(t,e,i,s,n){let a=e||new Z4ArrowPainter,r=i||new Z4GradientColor,o=document.body.classList.contains("z4-dark")?"white":"black";this.initDraw(s,n).forEach((e=>{this.draw(Z4Action.START,e.x,e.y),t.save(),t.lineWidth=1,t.fillStyle=Z4Color.getFillStyle(o),t.beginPath(),t.arc(this.P.x,this.P.y,2,0,Z4Math.TWO_PI),t.fill(),t.restore();let i=null;for(;null!==(i=this.next());){let e=i.getZ4Vector();t.save(),t.translate(e.getX0(),e.getY0()),t.rotate(e.getPhase()),a.draw(t,i,r),t.restore()}}))}initDraw(t,e){let i=new Array;for(let s=50;s<=t;s+=100)for(let t=50;t<=e;t+=100){let e=new Object;e.x=s,e.y=t,i.push(e)}return i}getIntensity(){return this.intensity}setIntensity(t){return this.intensity=t,this}getMultiplicity(){return this.multiplicity}setMultiplicity(t){return this.multiplicity=t,this}getPush(){return this.push}setPush(t){return this.push=t,this}}class Z4Tracer extends Z4PointIterator{intensity=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(1).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));multiplicity=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(1).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));push=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(0).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));attack=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(0).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));sustain=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(0).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));release=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(0).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));endlessSustain=!0;step=(new Z4FancifulValue).setConstant((new Z4SignedValue).setValue(10).setSign(Z4Sign.POSITIVE)).setRandom(Z4SignedRandomValue.classic(0).setSign(Z4Sign.POSITIVE));path=null;before=new Object;envelopeA=0;envelopeS=0;envelopeR=0;envelopeAS=0;envelopeASR=0;envelopePosition=0;envelopeStep=0;clones=new Array;clonePos=0;fromClones=!1;surplus=0;connect=!1;currentVector=null;currentMultiplicityCounter=0;currentMultiplicityTotal=0;constructor(){super(),this.before.x=0,this.before.y=0}draw(t,e,i){if(t===Z4Action.START)return this.P.x=e,this.P.y=i,this.hasNext=!1,this.path=null,this.envelopeA=this.attack.next(),this.envelopeS=this.sustain.next(),this.envelopeR=this.release.next(),this.envelopeAS=this.envelopeA+this.envelopeS,this.envelopeASR=this.envelopeA+this.envelopeS+this.envelopeR,this.envelopePosition=0,this.envelopeStep=this.step.next(),this.clones=new Array,this.fromClones=!1,this.surplus=0,this.connect=!1,!1;if(t===Z4Action.CONTINUE){this.currentMultiplicityCounter=0,this.currentMultiplicityTotal=parseInt(this.multiplicity.next());let t=Z4Math.distance(this.P.x,this.P.y,e,i);if(t>=10){let s=Z4Math.atan(this.P.x,this.P.y,e,i),n=Z4Vector.fromVector(this.P.x,this.P.y,2*t/3,s),a=new Object;a.x=n.getX(),a.y=n.getY(),this.connect?(n=Z4Vector.fromVector(this.P.x,this.P.y,t/3,s),this.path=Z4TracerPath.fromQuadAndLine(this.before.x,this.before.y,this.P.x,this.P.y,n.getX(),n.getY(),a.x,a.y,this.surplus,this.envelopeStep)):this.path=Z4TracerPath.fromLine(this.P.x,this.P.y,n.getX(),n.getY(),this.surplus,this.envelopeStep),this.connect=!0,this.before=a,this.P.x=e,this.P.y=i,this.hasNext=this.path.hasNext(),this.hasNext||(this.surplus=this.path.getNewSurplus())}else this.hasNext=!1;return!0}return t===Z4Action.STOP&&(this.fromClones=!0,this.clonePos=0,this.hasNext=this.clonePos<this.clones.length,!0)}next(){if(this.hasNext){if(this.fromClones){let t=this.clones[this.clonePos];return t.setColorPosition(this.clonePos/this.clones.length),t.setDrawBounds(!1),this.clonePos++,this.hasNext=this.clonePos<this.clones.length,t}{this.currentMultiplicityCounter||(this.currentVector=this.path.next());let t=this.rotation.next(this.currentVector.getPhase()),e=this.push.next();if(e){let i=Z4Vector.fromVector(this.currentVector.getX0(),this.currentVector.getY0(),e,t);this.z4Point.setZ4Vector(Z4Vector.fromVector(i.getX(),i.getY(),1,t))}else this.z4Point.setZ4Vector(Z4Vector.fromVector(this.currentVector.getX0(),this.currentVector.getY0(),1,t));return this.z4Point.setIntensity(this.nextEnvelope()*this.intensity.next()),this.rotation.nextSide(this.z4Point,this.currentVector),this.progression.next(this.z4Point),this.z4Point.isDrawBounds()&&this.z4Point.getIntensity()>0&&this.clones.push(this.z4Point.clone()),this.currentMultiplicityCounter++,this.currentMultiplicityCounter>=this.currentMultiplicityTotal&&(this.currentMultiplicityCounter=0,this.hasNext=this.path.hasNext(),this.hasNext||(this.surplus=this.path.getNewSurplus())),this.z4Point}}return null}nextEnvelope(){return this.envelopePosition<this.envelopeA?(this.envelopePosition++,this.envelopePosition/this.envelopeA):this.envelopePosition<this.envelopeAS||this.endlessSustain?(this.envelopePosition++,1):this.envelopePosition<this.envelopeASR?(this.envelopePosition++,1-(this.envelopePosition-this.envelopeAS)/this.envelopeR):0}drawDemo(t,e,i,s,n){e=e||new Z4ArrowPainter,i=i||new Z4GradientColor;let a=document.body.classList.contains("z4-dark")?"white":"black",r=s>n?new Bezier(s/10,n/3,s/2,3*n/2,s/2,-n/2,9*s/10,n/2):new Bezier(s/3,9*n/10,3*s/2,n/2,-s/2,n/2,s/2,n/10),o=r.get(0);this.draw(Z4Action.START,o.x,o.y);for(let s=.1;s<1;s+=.1)o=r.get(s),this.draw(Z4Action.CONTINUE,o.x,o.y),this.drawDemoPoint(t,o,e,i,a);o=r.get(1),this.draw(Z4Action.CONTINUE,o.x,o.y),this.drawDemoPoint(t,o,e,i,a),this.draw(Z4Action.STOP,o.x,o.y),this.drawDemoPoint(t,o,e,i,a)}drawDemoPoint(t,e,i,s,n){t.save(),t.lineWidth=1,t.fillStyle=Z4Color.getFillStyle(n),t.beginPath(),t.arc(e.x,e.y,2,0,Z4Math.TWO_PI),t.fill(),t.restore();let a=null;for(;null!==(a=this.next());){let e=a.getZ4Vector();t.save(),t.translate(e.getX0(),e.getY0()),t.rotate(e.getPhase()),i.draw(t,a,s),t.restore()}}getIntensity(){return this.intensity}setIntensity(t){return this.intensity=t,this}getMultiplicity(){return this.multiplicity}setMultiplicity(t){return this.multiplicity=t,this}getPush(){return this.push}setPush(t){return this.push=t,this}setEnvelope(t,e,i,s){return this.attack=t,this.sustain=e,this.release=i,this.endlessSustain=s,this}getAttack(){return this.attack}getRelease(){return this.release}getSustain(){return this.sustain}isEndlessSustain(){return this.endlessSustain}setStep(t){return this.step=t,this}getStep(){return this.step}}class Z4Spirograph extends Z4PointIterator{center=new Object;clones=new Array;clonePos=0;fromClones=!1;constructor(){super(),this.z4Point.setUseVectorModuleAsSize(!0),this.P.x=0,this.P.y=0}draw(t,e,i){return t===Z4Action.START?(this.center.x=e,this.center.y=i,this.hasNext=!1,this.clones=new Array,this.fromClones=!1,!1):t===Z4Action.CONTINUE?(this.P.x=e,this.P.y=i,this.hasNext=!0,!0):t===Z4Action.STOP&&(this.fromClones=!0,this.clonePos=this.clones.length-1,this.hasNext=-1!==this.clonePos,!0)}next(){if(this.hasNext){if(this.fromClones){let t=this.clones[this.clonePos];return t.setColorPosition(this.clonePos/this.clones.length),t.setDrawBounds(!1),this.clonePos--,this.hasNext=-1!==this.clonePos,t}{let t=Z4Vector.fromPoints(this.center.x,this.center.y,this.P.x,this.P.y),e=this.rotation.next(t.getPhase());return this.z4Point.setZ4Vector(Z4Vector.fromVector(this.center.x,this.center.y,t.getModule(),e)),this.rotation.nextSide(this.z4Point,t),this.progression.next(this.z4Point),this.z4Point.isDrawBounds()&&this.clones.push(this.z4Point.clone()),this.hasNext=!1,this.z4Point}}return null}drawDemo(t,e,i,s,n){let a=e||new Z4ArrowPainter,r=i||new Z4GradientColor,o=this.initDraw(s,n),l=o[0];this.draw(Z4Action.START,l.x,l.y),o.slice(1).forEach((e=>{this.draw(Z4Action.CONTINUE,e.x,e.y),this.drawDemoPoint(t,a,r)}));let h=o[o.length-1];this.draw(Z4Action.STOP,h.x,h.y),this.drawDemoPoint(t,a,r)}initDraw(t,e){let i=t/2,s=e/2,n=Math.min(t,e)/16,a=new Array,r=parseInt(t*e/1e4);for(let t=0;t<r;t++){let e=Z4Math.TWO_PI*t/r,o=new Object;o.x=i+n*e*Math.cos(e),o.y=s+n*e*Math.sin(e),a.push(o)}return a}drawDemoPoint(t,e,i){let s=null;for(;null!==(s=this.next());){let n=s.getZ4Vector();t.save(),t.translate(n.getX0(),n.getY0()),t.rotate(n.getPhase()),e.draw(t,s,i),t.restore()}}}class Z4StamperUI extends Z4AbstractComponentWithValueUI{canvas=this.querySelector(".stamper-canvas");ctx=this.canvas.getContext("2d");intensity=(new Z4FancifulValueUI).setValueLabel("INTENSITY",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".stamper-container-first-row"));rotation=(new Z4RotationUI).setValueLabel("ROTATION",!0,!0).appendToElement(this.querySelector(".stamper-container"));multiplicity=(new Z4FancifulValueUI).setValueLabel("MULTIPLICITY",!0,!0).setConstantRange(1,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".stamper-container-first-row"));push=(new Z4FancifulValueUI).setValueLabel("PUSH",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".stamper-container-first-row"));progression=(new Z4ProgressionUI).setProgressionLabel("FILLING",!0,!0).appendToElement(this.querySelector(".stamper-container"));resizeObserver=new ResizeObserver((()=>this.drawCanvas()));mutationObserver=new MutationObserver((()=>this.drawCanvas()));static UI=Z4HTMLFactory.get("giada/pizzapazza/iterator/ui/Z4StamperUI.html");constructor(){super(Z4StamperUI.UI),this.initDevicePixelRatio((()=>this.drawCanvas())),this.resizeObserver.observe(this.canvas);let t=new Object;t.attributeFilter=new Array("class"),this.mutationObserver.observe(document.body,t),this.intensity.oninput=t=>this.set(t,null,null,null,null,!1),this.intensity.onchange=t=>this.set(t,null,null,null,null,!0),this.rotation.oninput=t=>this.set(null,t,null,null,null,!1),this.rotation.onchange=t=>this.set(null,t,null,null,null,!0),this.multiplicity.oninput=t=>this.set(null,null,t,null,null,!1),this.multiplicity.onchange=t=>this.set(null,null,t,null,null,!0),this.push.oninput=t=>this.set(null,null,null,t,null,!1),this.push.onchange=t=>this.set(null,null,null,t,null,!0),this.progression.oninput=t=>this.set(null,null,null,null,t,!1),this.progression.onchange=t=>this.set(null,null,null,null,t,!0),this.setValue(new Z4Stamper)}set(t,e,i,s,n,a){t&&this.value.setIntensity(t),e&&this.value.setRotation(e),i&&this.value.setMultiplicity(i),s&&this.value.setPush(s),n&&this.value.setProgression(n),this.drawCanvas(),a?this.onchange(this.value):this.oninput(this.value)}setValue(t){return this.value=t,this.intensity.setValue(this.value.getIntensity()),this.rotation.setValue(this.value.getRotation()),this.multiplicity.setValue(this.value.getMultiplicity()),this.push.setValue(this.value.getPush()),this.progression.setValue(this.value.getProgression()),this.drawCanvas(),this}drawCanvas(){if(this.canvas.clientWidth){this.canvas.width=Math.floor(this.canvas.clientWidth*window.devicePixelRatio),this.canvas.height=Math.floor(this.canvas.clientHeight*window.devicePixelRatio);let t=new OffscreenCanvas(this.canvas.clientWidth,this.canvas.clientHeight),e=t.getContext("2d");this.value.drawDemo(e,null,null,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.drawImage(t,0,0),this.ctx.restore()}}dispose(){this.disposeDevicePixelRatio(),this.resizeObserver.unobserve(this.canvas),this.mutationObserver.unobserve(document.body)}}class Z4TracerUI extends Z4AbstractComponentWithValueUI{canvas=this.querySelector(".tracer-canvas");ctx=this.canvas.getContext("2d");intensity=(new Z4FancifulValueUI).setValueLabel("INTENSITY",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-first-row"));rotation=(new Z4RotationUI).setValueLabel("ROTATION",!0,!0).appendToElement(this.querySelector(".tracer-container"));multiplicity=(new Z4FancifulValueUI).setValueLabel("MULTIPLICITY",!0,!0).setConstantRange(1,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-first-row"));push=(new Z4FancifulValueUI).setValueLabel("PUSH",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-first-row"));progression=(new Z4ProgressionUI).setProgressionLabel("FILLING",!0,!0).appendToElement(this.querySelector(".tracer-container"));attack=(new Z4FancifulValueUI).setValueLabel("ATTACK",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-second-row"));sustain=(new Z4FancifulValueUI).setValueLabel("SUSTAIN",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-second-row"));release=(new Z4FancifulValueUI).setValueLabel("RELEASE",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-second-row"));endlessSustainCheck=this.querySelector(".tracer-endless-sustain-check");step=(new Z4FancifulValueUI).setValueLabel("STEP",!0,!0).setConstantRange(0,50,!1).setRandomRange(0,50,!1).setRandomLengthRange(1,100,!1).setSignsVisible(!1).appendToElement(this.querySelector(".tracer-container-third-row"));resizeObserver=new ResizeObserver((()=>this.drawCanvas()));mutationObserver=new MutationObserver((()=>this.drawCanvas()));static UI=Z4HTMLFactory.get("giada/pizzapazza/iterator/ui/Z4TracerUI.html");constructor(){super(Z4TracerUI.UI),this.initDevicePixelRatio((()=>this.drawCanvas())),this.resizeObserver.observe(this.canvas);let t=new Object;t.attributeFilter=new Array("class"),this.mutationObserver.observe(document.body,t),this.intensity.oninput=t=>this.set(t,null,null,null,null,null,!1),this.intensity.onchange=t=>this.set(t,null,null,null,null,null,!0),this.rotation.oninput=t=>this.set(null,t,null,null,null,null,!1),this.rotation.onchange=t=>this.set(null,t,null,null,null,null,!0),this.multiplicity.oninput=t=>this.set(null,null,t,null,null,null,!1),this.multiplicity.onchange=t=>this.set(null,null,t,null,null,null,!0),this.push.oninput=t=>this.set(null,null,null,t,null,null,!1),this.push.onchange=t=>this.set(null,null,null,t,null,null,!0),this.step.oninput=t=>this.set(null,null,null,null,t,null,!1),this.step.onchange=t=>this.set(null,null,null,null,t,null,!0),this.progression.oninput=t=>this.set(null,null,null,null,null,t,!1),this.progression.onchange=t=>this.set(null,null,null,null,null,t,!0),this.attack.oninput=t=>this.setEnvelope(!1),this.attack.onchange=t=>this.setEnvelope(!0),this.sustain.oninput=t=>this.setEnvelope(!1),this.sustain.onchange=t=>this.setEnvelope(!0),this.release.oninput=t=>this.setEnvelope(!1),this.release.onchange=t=>this.setEnvelope(!0),this.endlessSustainCheck.id=this.getUniqueID(),this.querySelector(".tracer-endless-sustain-label").setAttribute("for",this.endlessSustainCheck.id),this.endlessSustainCheck.onchange=t=>(this.sustain.setEnabled(!this.endlessSustainCheck.checked),this.release.setEnabled(!this.endlessSustainCheck.checked),this.value.setEnvelope(this.attack.getValue(),this.sustain.getValue(),this.release.getValue(),this.endlessSustainCheck.checked),this.drawCanvas(),this.onchange(this.value),null),this.sustain.querySelector(".fanciful-value-label").parentElement.insertBefore(this.querySelector(".tracer-endless-sustain-switch"),this.sustain.querySelector(".fanciful-value-container")),this.setValue(new Z4Tracer)}set(t,e,i,s,n,a,r){t&&this.value.setIntensity(t),e&&this.value.setRotation(e),i&&this.value.setMultiplicity(i),s&&this.value.setPush(s),n&&this.value.setStep(n),a&&this.value.setProgression(a),this.drawCanvas(),r?this.onchange(this.value):this.oninput(this.value)}setEnvelope(t){this.value.setEnvelope(this.attack.getValue(),this.sustain.getValue(),this.release.getValue(),this.endlessSustainCheck.checked),this.drawCanvas(),t?this.onchange(this.value):this.oninput(this.value)}setValue(t){return this.value=t,this.intensity.setValue(this.value.getIntensity()),this.rotation.setValue(this.value.getRotation()),this.multiplicity.setValue(this.value.getMultiplicity()),this.push.setValue(this.value.getPush()),this.step.setValue(this.value.getStep()),this.progression.setValue(this.value.getProgression()),this.attack.setValue(this.value.getAttack()),this.sustain.setValue(this.value.getSustain()),this.release.setValue(this.value.getRelease()),this.endlessSustainCheck.checked=this.value.isEndlessSustain(),this.sustain.setEnabled(!this.endlessSustainCheck.checked),this.release.setEnabled(!this.endlessSustainCheck.checked),this.drawCanvas(),this}drawCanvas(){if(this.canvas.clientWidth){this.canvas.width=Math.floor(this.canvas.clientWidth*window.devicePixelRatio),this.canvas.height=Math.floor(this.canvas.clientHeight*window.devicePixelRatio);let t=new OffscreenCanvas(this.canvas.clientWidth,this.canvas.clientHeight),e=t.getContext("2d");this.value.drawDemo(e,null,null,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.drawImage(t,0,0),this.ctx.restore()}}dispose(){this.disposeDevicePixelRatio(),this.resizeObserver.unobserve(this.canvas),this.mutationObserver.unobserve(document.body)}}class Z4SpirographUI extends Z4AbstractComponentWithValueUI{canvas=this.querySelector(".spirograph-canvas");ctx=this.canvas.getContext("2d");rotation=(new Z4RotationUI).setValueLabel("ROTATION",!0,!0).appendToElement(this.querySelector(".spirograph-container"));progression=(new Z4ProgressionUI).setProgressionLabel("FILLING",!0,!0).appendToElement(this.querySelector(".spirograph-container"));resizeObserver=new ResizeObserver((()=>this.drawCanvas()));mutationObserver=new MutationObserver((()=>this.drawCanvas()));static UI=Z4HTMLFactory.get("giada/pizzapazza/iterator/ui/Z4SpirographUI.html");constructor(){super(Z4SpirographUI.UI),this.initDevicePixelRatio((()=>this.drawCanvas())),this.resizeObserver.observe(this.canvas);let t=new Object;t.attributeFilter=new Array("class"),this.mutationObserver.observe(document.body,t),this.rotation.oninput=t=>{this.oninput(this.value.setRotation(t)),this.drawCanvas()},this.rotation.onchange=t=>{this.onchange(this.value.setRotation(t)),this.drawCanvas()},this.progression.oninput=t=>{this.oninput(this.value.setProgression(t)),this.drawCanvas()},this.progression.onchange=t=>{this.onchange(this.value.setProgression(t)),this.drawCanvas()},this.setValue(new Z4Spirograph)}setValue(t){return this.value=t,this.rotation.setValue(this.value.getRotation()),this.progression.setValue(this.value.getProgression()),this.drawCanvas(),this}drawCanvas(){if(this.canvas.clientWidth){this.canvas.width=Math.floor(this.canvas.clientWidth*window.devicePixelRatio),this.canvas.height=Math.floor(this.canvas.clientHeight*window.devicePixelRatio);let t=new OffscreenCanvas(this.canvas.clientWidth,this.canvas.clientHeight),e=t.getContext("2d");this.value.drawDemo(e,null,null,this.canvas.clientWidth,this.canvas.clientHeight),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.drawImage(t,0,0),this.ctx.restore()}}dispose(){this.disposeDevicePixelRatio(),this.resizeObserver.unobserve(this.canvas),this.mutationObserver.unobserve(document.body)}}
//# sourceMappingURL=bundle-0.19.0.min.js.map