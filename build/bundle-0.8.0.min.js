class Z4Setting{static language=Z4Setting.initLanguage();static theme=Z4Setting.initTheme();static mode=Z4Setting.initMode();static initLanguage(){let t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();if(i.startsWith("z4language"))return i.substring(11)}return navigator.languages?navigator.languages[0].substring(0,2):navigator.language?navigator.language.substring(0,2):navigator.userLanguage?navigator.userLanguage.substring(0,2):"en"}static initTheme(){Z4Setting.theme="auto";let t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();i.startsWith("z4theme")&&(Z4Setting.theme=i.substring(8))}return Z4Setting.setTheme(Z4Setting.theme),Z4Setting.theme}static initMode(){Z4Setting.mode="standard";let t=decodeURIComponent(document.cookie).split(";");for(let e=0;e<t.length;e++){let i=t[e].trim();i.startsWith("z4mode")&&(Z4Setting.mode=i.substring(7))}return Z4Setting.setMode(Z4Setting.mode),Z4Setting.mode}static setLanguage(t){let e=new Date;e.setTime(e.getTime()+31536e6),document.cookie="z4language="+t+";expires="+e.toUTCString()+";path="+Z4Loader.path,Z4Setting.language=t}static getLanguage(){return Z4Setting.language}static setTheme(t){Z4Setting.theme=t;let e=new Date;switch(e.setTime(e.getTime()+31536e6),document.cookie="z4theme="+t+";expires="+e.toUTCString()+";path="+Z4Loader.path,Z4Setting.theme){case"auto":window.matchMedia?Z4Setting.addDarkModeListener():document.body.classList.remove("z4-dark");break;case"light":document.body.classList.remove("z4-dark");break;case"dark":document.body.classList.add("z4-dark")}}static addDarkModeListener(){if("auto"===Z4Setting.theme){window.matchMedia("(prefers-color-scheme: dark)").matches?document.body.classList.add("z4-dark"):document.body.classList.remove("z4-dark");let t=new Object;t.once=!0,window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(()=>Z4Setting.addDarkModeListener()),t)}}static getTheme(){return Z4Setting.theme}static setMode(t){Z4Setting.mode=t,document.body.classList.remove("z4-lite"),document.body.classList.remove("z4-standard"),document.body.classList.remove("z4-pro"),document.body.classList.add("z4-"+t);let e=new Date;e.setTime(e.getTime()+31536e6),document.cookie="z4mode="+t+";expires="+e.toUTCString()+";path="+Z4Loader.path}static getMode(){return Z4Setting.mode}static isLiteMode(){return"lite"===Z4Setting.mode}static isStandardMode(){return"standard"===Z4Setting.mode}static isProMode(){return"pro"===Z4Setting.mode}constructor(){}}class Z4HTMLFactory{static HTML=Z4HTMLFactory.initHTML();static get(t){return Z4HTMLFactory.HTML[t]}static initHTML(){let t=new Array,e=new XMLHttpRequest;return Z4Loader.allFiles?(e.open("GET",Z4Loader.UP+"src/giada/html_list.properties?random="+Math.random(),!1),e.send(),new String(e.responseText).split("\n").forEach((i=>{i&&!i.startsWith("#")&&(e.open("GET",Z4Loader.UP+"src/"+i,!1),e.send(),t[i]=e.responseText)}))):(e.open("GET",Z4Loader.UP+"build/bundle-"+Z4Loader.version+".html",!1),e.send(),Z4HTMLFactory.readHTMLs(t,e.responseText)),t}static readHTMLs(t,e){new String(e).split("\n").forEach((e=>{if(e){let i=e.split(":=");t[i[0].trim()]=i[1].trim()}}))}constructor(){}}class Z4MessageFactory{static MESSAGE=Z4MessageFactory.initMessages();static get(t){return Z4MessageFactory.MESSAGE[t]}static changingLanguage(){Z4MessageFactory.MESSAGE=Z4MessageFactory.initMessages(),document.querySelectorAll("[data-token-lang-inner_text]").forEach((t=>t.innerText=Z4MessageFactory.get(t.getAttribute("data-token-lang-inner_text"))))}static initMessages(){let t=new Array,e=Z4Loader.UP+(Z4Loader.allFiles?"src/message/":"build/message/"),i=Z4Loader.allFiles?"message-"+Z4Setting.getLanguage()+".properties?random="+Math.random():"message-"+Z4Setting.getLanguage()+"-"+Z4Loader.version+".properties",o=new XMLHttpRequest;if(o.open("GET",e+i,!1),o.send(),Z4MessageFactory.readMessages(t,o.responseText),0===Object.keys(t).length){Z4Setting.setLanguage("en"),i=Z4Loader.allFiles?"message-en.properties?random="+Math.random():"message-en-"+Z4Loader.version+".properties";let o=new XMLHttpRequest;o.open("GET",e+i,!1),o.send(),Z4MessageFactory.readMessages(t,o.responseText)}return t}static readMessages(t,e){new String(e).split("\n").forEach((e=>{if(e&&!e.startsWith("#")){let i=e.split("=");t[i[0].trim()]=i[1].trim()}}))}constructor(){}}class Z4ImageFactory{static IMAGES=Z4ImageFactory.initImages();static get(t){return Z4ImageFactory.IMAGES[t]}static initImages(){let t=new Array,e=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/"),i=Z4Loader.allFiles?"image_list.properties?random="+Math.random():"image_list-"+Z4Loader.version+".properties",o=new XMLHttpRequest;return o.open("GET",e+i,!1),o.send(),Z4ImageFactory.readImages(e,t,new String(o.responseText).split("\n")),t}static readImages(t,e,i){i.forEach((o=>{if(o&&!o.startsWith("#")){let s=o.split("="),r=new Image;r.onload=o=>Z4ImageFactory.readImages(t,e,i.slice(1)),r.src=t+s[1].trim(),e[s[0].trim()]=r}}))}constructor(){}}class Z4ComponentUI{html=null;onchange=t=>{};oninput=t=>{};constructor(t){this.html=document.createElement("div"),this.html.setAttribute("id","id"+(new Date).getTime()+"_"+parseInt(1e3*Math.random())),this.html.innerHTML=t;let e=this.html.querySelectorAll("#"+this.html.id+" [data-token-lang-inner_text]");for(let t=0;t<e.length;t++){let i=e.item(t);i.innerText=Z4MessageFactory.get(i.getAttribute("data-token-lang-inner_text"))}}querySelector(t){return this.html.querySelector(t)}querySelectorAll(t){return this.html.querySelectorAll(t)}appendTo(t){return t.appendChild(this.html),this}}class Z4ModalMessageUI{static html=Z4ModalMessageUI.loadHTML();static modal=new bootstrap.Modal(Z4ModalMessageUI.html);static loadHTML(){let t=document.createElement("div");return t.setAttribute("id",(new Date).getTime()+"-"+parseInt(1e3*Math.random())),t.setAttribute("data-bs-backdrop","static"),t.setAttribute("data-bs-keyboard","false"),t.setAttribute("tabindex","-1"),t.setAttribute("style","display:none"),t.className="modal modal-dialog-centered fade",t.innerHTML=Z4HTMLFactory.get("giada/pizzapazza/ui/Z4ModalMessageUI.html"),document.body.appendChild(t),t}static showInfo(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-info-circle-fill","#0dcaf0")}static showWarning(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-exclamation-triangle-fill","#ffc107")}static showError(t,e,i){Z4ModalMessageUI.showOneButton(t,e,i,"bi bi-exclamation-octagon-fill","#dc3545")}static showOneButton(t,e,i,o,s){Z4ModalMessageUI.html.querySelector(".modal-title").innerText=t,Z4ModalMessageUI.html.querySelector(".modal-message").innerText=e;let r=Z4ModalMessageUI.html.querySelector(".modal-icon i");r.className=o,r.style.color=s;let n=Z4ModalMessageUI.html.querySelector(".modal-footer");n.innerHTML="",Z4ModalMessageUI.appendButton(Z4MessageFactory.get("OK"),"btn btn-primary",i,n),Z4ModalMessageUI.modal.show()}static showQuestion(t,e,i,o,s,r){Z4ModalMessageUI.html.querySelector(".modal-title").innerText=t,Z4ModalMessageUI.html.querySelector(".modal-message").innerText=e;let n=Z4ModalMessageUI.html.querySelector(".modal-icon i");n.className="bi bi-question-circle-fill",n.style.color="#6c757d";let a=Z4ModalMessageUI.html.querySelector(".modal-footer");a.innerHTML="",i&&Z4ModalMessageUI.appendButton(Z4MessageFactory.get("YES"),"btn btn-primary",i,a),o&&Z4ModalMessageUI.appendButton(Z4MessageFactory.get("NO"),"btn btn-secondary",o,a),s&&Z4ModalMessageUI.appendButton(Z4MessageFactory.get("OK"),"btn btn-primary",s,a),r&&Z4ModalMessageUI.appendButton(Z4MessageFactory.get("CANCEL"),"btn btn-secondary",r,a),Z4ModalMessageUI.modal.show()}static appendButton(t,e,i,o){let s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("data-bs-dismiss","modal"),s.className=e,s.innerText=t,s.onclick=t=>(i(),null),o.appendChild(s)}constructor(){}}class Z4Math{static TWO_PI=2*Math.PI;static HALF_PI=Math.PI/2;static GOLD_SECTION=(1+Math.sqrt(5))/2;static SQUARE_GOLD_SECTION=Z4Math.GOLD_SECTION*Z4Math.GOLD_SECTION;static RAD2DEG=180/Math.PI;static DEG2RAD=Math.PI/180;static rad2deg(t){return t*Z4Math.RAD2DEG}static deg2rad(t){return t*Z4Math.DEG2RAD}static distance(t,e,i,o){let s=t-i,r=e-o;return Math.sqrt(s*s+r*r)}static atan(t,e,i,o){let s=Math.atan2(o-e,i-t);return s<0?s+Z4Math.TWO_PI:s}static ripple(t,e,i,o){let s=(i-e)*o*Math.random();return(t+=Math.random()>.5?s:-s)<e?e:t>i?i:t}constructor(){}}class Z4Sign{static POSITIVE=new Z4Sign(1);static NEGATIVE=new Z4Sign(-1);static RANDOM=new Z4Sign(0);sign=0;constructor(t){this.sign=t}next(){switch(this.sign){case 1:case-1:return this.sign;case 0:default:return Math.random()>.5?1:-1;case 2:case-2:return this.sign*=-1,this.sign/2}}static alternate(){return new Z4Sign(-2)}}class Z4RandomValue{value=0;type=0;length=0;step=0;prevRandom=0;controlRandom=0;nextRandom=0;bezierCurve=null;constructor(t,e,i){this.value=t,this.type=e,this.length=i,this.step=0,this.prevRandom=Math.random(),this.controlRandom=1,this.nextRandom=Math.random(),1===this.type&&this.createBezierCurve()}createBezierCurve(){this.bezierCurve=new Bezier(0,this.prevRandom,this.length/2,this.controlRandom,1,this.nextRandom)}isClassic(){return 0===this.type}isBezier(){return 1===this.type}isPolyline(){return 2===this.type}isStepped(){return 3===this.type}getValue(){return this.value}getLength(){return this.length}next(){switch(this.type){case 0:default:return this.value*Math.random();case 1:return this.step===this.length?(this.step=0,this.prevRandom=this.nextRandom,this.controlRandom=1===this.controlRandom?0:1,this.nextRandom=Math.random(),this.createBezierCurve()):this.step++,value*this.bezierCurve.get(this.step/this.length).y;case 2:return this.step===this.length?(this.step=0,this.prevRandom=this.nextRandom,this.nextRandom=Math.random()):this.step++,value*((this.nextRandom-this.prevRandom)*this.step/this.length+this.prevRandom);case 3:return this.step===this.length?(this.step=0,this.prevRandom=Math.random()):this.step++,value*this.prevRandom}}static classic(t){return new Z4RandomValue(t,0,1)}static bezier(t,e){return new Z4RandomValue(t,1,e)}static polyline(t,e){return new Z4RandomValue(t,2,e)}static stepped(t,e){return new Z4RandomValue(t,3,e)}}class Z4FancifulValue{constantSign=Z4Sign.RANDOM;constantValue=0;randomSign=Z4Sign.RANDOM;randomValue=Z4RandomValue.classic(0);proportionalSign=Z4Sign.RANDOM;proportionalValue=0;uniformSign=!1;setConstant(t,e){return this.constantSign=t,this.constantValue=e,this}getConstantSign(){return this.constantSign}getConstantValue(){return this.constantValue}setRandom(t,e){return this.randomSign=t,this.randomValue=e,this}getRandomSign(){return this.randomSign}getRandomValue(){return this.randomValue}setProportional(t,e){return this.proportionalSign=t,this.proportionalValue=e,this}getProportionalSign(){return this.proportionalSign}getProportionalValue(){return this.proportionalValue}setUniformSign(t){return this.uniformSign=t,this}isUniformSign(){return this.uniformSign}next(t){return Z4Setting.isLiteMode()?this.constantSign.next()*this.constantValue:Z4Setting.isStandardMode()?this.uniformSign?this.constantSign.next()*(this.constantValue+this.randomValue.next()):this.constantSign.next()*this.constantValue+this.randomSign.next()*this.randomValue.next():Z4Setting.isProMode()?this.uniformSign?this.constantSign.next()*(this.constantValue+this.randomValue.next()+t*this.proportionalValue):this.constantSign.next()*this.constantValue+this.randomSign.next()*this.randomValue.next()+this.proportionalSign.next()*t*this.proportionalValue:0}}class Z4Shape2D{static CIRCLE=new Z4Shape2D(0);static TRIANGLE=new Z4Shape2D(3);static SQUARE=new Z4Shape2D(-4);static DIAMOND=new Z4Shape2D(4);static PENTAGON=new Z4Shape2D(5);static HEXAGON=new Z4Shape2D(6);static SEPTAGON=new Z4Shape2D(7);static HEPTAGON=new Z4Shape2D(8);static STAR=new Z4Shape2D(-5);path=new Path2D;constructor(t){let e=.5,i=0,o=0;switch(t){case 0:this.path.arc(0,0,e,0,Z4Math.TWO_PI);break;case-4:this.path.rect(-.5,-.5,1,1);break;case-5:i=-Z4Math.HALF_PI,o=Z4Math.TWO_PI/5;let s=e/Z4Math.SQUARE_GOLD_SECTION;this.path.moveTo(Math.cos(i)*e,Math.sin(i)*e),i=3*o+Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*s,Math.sin(i)*s);for(let t=1;t<5;t++)i=o*t-Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*e,Math.sin(i)*e),i=o*(t+3)+Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*s,Math.sin(i)*s);break;default:i=-Z4Math.HALF_PI,o=Z4Math.TWO_PI/t,this.path.moveTo(Math.cos(i)*e,Math.sin(i)*e);for(let s=1;s<t;s++)i=o*s-Z4Math.HALF_PI,this.path.lineTo(Math.cos(i)*e,Math.sin(i)*e)}this.path.closePath()}getPath(){return path}}class Z4Vector{x0=0;y0=0;x=0;y=0;module=0;phase=0;constructor(t,e,i,o,s,r){this.x0=t,this.y0=e,this.x=i,this.y=o,this.module=s,this.phase=r}static fromPoints(t,e,i,o){return new Z4Vector(t,e,i,o,Z4Math.distance(t,e,i,o),Z4Math.atan(t,e,i,o))}static fromVector(t,e,i,o){return new Z4Vector(t,e,t+i*Math.cos(o),e+i*Math.sin(o),i,o)}clone(){return new Z4Vector(this.x0,this.y0,this.x,this.y,this.module,this.phase)}getX0(){return this.x0}getY0(){return this.y0}getX(){return this.x}getY(){return this.y}getModule(){return this.module}getPhase(){return this.phase}direction(t){let e=this.x-this.x0,i=this.y-this.y0,o=t.x-t.x0,s=t.y-t.y0;return Math.atan2(e*s-i*o,e*o+i*s)>=0?Z4Sign.POSITIVE:Z4Sign.NEGATIVE}}class Z4Point{z4Vector=Z4Vector.fromPoints(0,0,1,1);intensity=1;lighting=Z4Lighting.NONE;colorPosition=-1;drawBounds=!1;side=Z4Sign.RANDOM;useVectorModuleAsSize=!1;clone(){let t=new Z4Point;return t.z4Vector=this.z4Vector.clone(),t.intensity=this.intensity,t.lighting=this.lighting,t.colorPosition=this.colorPosition,t.drawBounds=this.drawBounds,t.side=this.side,t.useVectorModuleAsSize=this.useVectorModuleAsSize,t}getZ4Vector(){return this.z4Vector}setZ4Vector(t){return this.z4Vector=t,this}getIntensity(){return this.intensity}getLighting(){return this.lighting}setLighting(t){return this.lighting=t,this}getColorPosition(){return this.colorPosition}setColorPosition(t){return this.colorPosition=t,this}isDrawBounds(){return this.drawBounds}setSide(t){return this.side=t,this}isUseVectorModuleAsSize(){return this.useVectorModuleAsSize}}class Z4NumberUI extends Z4ComponentUI{toggle=this.querySelector(".sign-button");toggleImg=this.querySelector(".sign-button img");value=this.querySelector(".value");spinner=this.querySelector(".spinner");applySpin=()=>this.spin();isApplySpin=!1;static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4NumberUI.html");constructor(){super(Z4NumberUI.UI),this.toggleImg.setAttribute("src",Z4NumberUI.PATH+"z4sign_"+this.toggle.getAttribute("data-value")+".svg");let t=this.querySelectorAll(".dropdown-menu img");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4NumberUI.PATH+"z4sign_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".dropdown-item");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>(this.toggle.setAttribute("data-value",i.getAttribute("data-value")),this.toggleImg.setAttribute("src",Z4NumberUI.PATH+"z4sign_"+i.getAttribute("data-value")+".svg"),this.onchange(null),null)}this.value.oninput=t=>(this.oninput(null),null),this.value.onchange=t=>(this.onchange(null),null),this.value.onfocus=t=>(this.value.select(),null),Z4Loader.touch?(this.spinner.ontouchstart=t=>this.startSpin(),this.spinner.ontouchend=t=>this.stopSpin()):(this.spinner.onmousedown=t=>this.startSpin(),this.spinner.onmouseup=t=>this.stopSpin())}startSpin(){return this.isApplySpin=!0,this.applySpin(),null}stopSpin(){return this.isApplySpin=!1,this.spinner.value="0",null}spin(){let t=parseFloat(this.value.getAttribute("min")),e=parseFloat(this.value.getAttribute("max")),i=this.spinner.valueAsNumber,o=1;i&&(o=Math.abs(i),i=Math.max(t,this.value.valueAsNumber+(i>0?1:-1)),i=Math.min(i,e),this.value.value=""+i,this.oninput(null)),this.isApplySpin?setTimeout(this.applySpin,500/o):this.onchange(null)}setRange(t,e){return this.value.setAttribute("min",""+t),this.value.setAttribute("max",""+e),this}setSignVisible(t){return t?(this.querySelector(".number-group").classList.add("input-group"),this.querySelector(".sign-label").classList.remove("sign-label-not-visible"),this.toggle.classList.remove("sign-toggle-not-visible")):(this.querySelector(".number-group").classList.remove("input-group"),this.querySelector(".sign-label").classList.add("sign-label-not-visible"),this.toggle.classList.add("sign-toggle-not-visible")),this}setValueLabel(t){let e=this.querySelector(".value-label");return e.setAttribute("data-token-lang-inner_text",t),e.innerText=Z4MessageFactory.get(t),this}setSign(t){let e=null;return e=t===Z4Sign.POSITIVE?"positive":t===Z4Sign.NEGATIVE?"negative":t===Z4Sign.RANDOM?"random":"alternate",this.toggle.setAttribute("data-value",e),this.toggleImg.setAttribute("src",Z4NumberUI.PATH+"z4sign_"+e+".svg"),this}getSign(){switch(this.toggle.getAttribute("data-value")){case"positive":return Z4Sign.POSITIVE;case"negative":return Z4Sign.NEGATIVE;case"random":return Z4Sign.RANDOM;case"alternate":return Z4Sign.alternate();default:return null}}setValue(t){return this.value.value=""+t,this}getValue(){return this.value.valueAsNumber}}class Z4FancifulValueUI extends Z4ComponentUI{uniformCheck=this.querySelector(".uniform-check");toggleUniform=this.querySelector(".toggle-uniform");toggleUniformImg=this.querySelector(".toggle-uniform img");constantUI=new Z4NumberUI;randomUI=new Z4NumberUI;proportionalUI=new Z4NumberUI;toggleRandom=this.querySelector(".toggle-random");toggleRandomImg=this.querySelector(".toggle-random img");valueLength=this.querySelector(".random-length");spinnerLength=this.querySelector(".random-length-spinner");fancifulValue=new Z4FancifulValue;constantSignVisible=!0;randomSignVisible=!0;proportionalSignVisible=!0;constantVisible=!0;randomVisible=!0;proportionalVisible=!0;selector=new Array;applySpin=()=>this.spin();isApplySpin=!1;static PATH=Z4Loader.UP+(Z4Loader.allFiles?"src/image/":"build/image/");static UI=Z4HTMLFactory.get("giada/pizzapazza/math/ui/Z4FancifulValueUI.html");constructor(){super(Z4FancifulValueUI.UI),this.uniformCheck.id="uniform_"+(new Date).getTime()+"_"+parseInt(1e3*Math.random()),this.querySelector(".uniform-label").setAttribute("for",this.uniformCheck.id),this.uniformCheck.onchange=t=>(this.setUI(),this.onchange(this.fancifulValue.setUniformSign(this.uniformCheck.checked)),null),this.toggleUniformImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4sign_"+this.toggleUniform.getAttribute("data-value")+".svg");let t=this.querySelectorAll(".toggle-uniform-dropdown-menu img");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4FancifulValueUI.PATH+"z4sign_"+i.getAttribute("data-icon")+".svg")}let e=this.querySelectorAll(".toggle-uniform-dropdown-menu .dropdown-item");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>(this.toggleUniform.setAttribute("data-value",i.getAttribute("data-value")),this.toggleUniformImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4sign_"+i.getAttribute("data-value")+".svg"),this.constantUI.setSign(this.getUniformSign()),this.onchange(this.fancifulValue.setConstant(this.getUniformSign(),this.constantUI.getValue())),null)}this.toggleRandomImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4randomvalue_"+this.toggleRandom.getAttribute("data-value")+".svg"),t=this.querySelectorAll(".toggle-random-dropdown-menu img");for(let e=0;e<t.length;e++){let i=t.item(e);i.setAttribute("src",Z4FancifulValueUI.PATH+"z4randomvalue_"+i.getAttribute("data-icon")+".svg")}e=this.querySelectorAll(".toggle-random-dropdown-menu .dropdown-item");for(let t=0;t<e.length;t++){let i=e.item(t);i.onclick=t=>{let e=i.getAttribute("data-value");return this.toggleRandom.setAttribute("data-value",e),this.toggleRandomImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4randomvalue_"+e+".svg"),this.querySelector(".divider-length").style.display="classic"===e?"none":"block",this.querySelector(".container-length").style.display="classic"===e?"none":"block",this.onchange(this.fancifulValue.setRandom(this.randomUI.getSign(),this.getRandom())),null}}this.valueLength.oninput=t=>(this.oninput(this.fancifulValue.setRandom(this.randomUI.getSign(),this.getRandom())),null),this.valueLength.onchange=t=>(this.onchange(this.fancifulValue.setRandom(this.randomUI.getSign(),this.getRandom())),null),this.valueLength.onfocus=t=>(this.valueLength.select(),null),Z4Loader.touch?(this.spinnerLength.ontouchstart=t=>this.startSpin(),this.spinnerLength.ontouchend=t=>this.stopSpin()):(this.spinnerLength.onmousedown=t=>this.startSpin(),this.spinnerLength.onmouseup=t=>this.stopSpin()),this.constantUI.appendTo(this.querySelector(".fanciful-costant")),this.constantUI.setValueLabel("CONSTANT"),this.randomUI.appendTo(this.querySelector("div.fanciful-random")),this.randomUI.setValueLabel("RANDOM"),this.proportionalUI.appendTo(this.querySelector(".fanciful-proportional")),this.proportionalUI.setValueLabel("PROPORTIONAL"),this.querySelector(".fanciful-random > div").prepend(this.querySelector(".random-type-label")),this.randomUI.querySelector(".number-group").prepend(this.querySelector(".toggle-random-dropdown-menu")),this.randomUI.querySelector(".number-group").prepend(this.toggleRandom),this.randomUI.querySelector(".sign-label").style.width="64px",this.constantUI.oninput=t=>this.onInput(),this.randomUI.oninput=t=>this.onInput(),this.proportionalUI.oninput=t=>this.onInput(),this.constantUI.onchange=t=>this.onChange(),this.randomUI.onchange=t=>this.onChange(),this.proportionalUI.onchange=t=>this.onChange(),this.setValue(this.fancifulValue)}onInput(){return this.setUniformSign(this.constantUI.getSign()),this.oninput(this.fancifulValue.setConstant(this.constantUI.getSign(),this.constantUI.getValue()).setRandom(this.randomUI.getSign(),this.getRandom()).setProportional(this.proportionalUI.getSign(),this.proportionalUI.getValue())),null}onChange(){return this.setUniformSign(this.constantUI.getSign()),this.onchange(this.fancifulValue.setConstant(this.constantUI.getSign(),this.constantUI.getValue()).setRandom(this.randomUI.getSign(),this.getRandom()).setProportional(this.proportionalUI.getSign(),this.proportionalUI.getValue())),null}startSpin(){return this.isApplySpin=!0,this.applySpin(),null}stopSpin(){return this.isApplySpin=!1,this.spinnerLength.value="0",null}spin(){let t=parseFloat(this.valueLength.getAttribute("min")),e=parseFloat(this.valueLength.getAttribute("max")),i=this.spinnerLength.valueAsNumber,o=1;i&&(o=Math.abs(i),i=Math.max(t,this.valueLength.valueAsNumber+(i>0?1:-1)),i=Math.min(i,e),this.valueLength.value=""+i,this.oninput(this.fancifulValue.setRandom(this.randomUI.getSign(),this.getRandom()))),this.isApplySpin?setTimeout(this.applySpin,500/o):this.onchange(this.fancifulValue.setRandom(this.randomUI.getSign(),this.getRandom()))}setComponentsVisible(t,e,i){return this.constantVisible=t,this.randomVisible=e,this.proportionalVisible=i,this.setUI(),this}setSignsVisible(t,e,i){return this.constantSignVisible=t,this.randomSignVisible=e,this.proportionalSignVisible=i,this.setUI(),this}setConstantRange(t,e){return this.constantUI.setRange(t,e),this}setRandomRange(t,e){return this.randomUI.setRange(t,e),this}setProportionalRange(t,e){return this.proportionalUI.setRange(t,e),this}setRandomLengthRange(t,e){return this.valueLength.setAttribute("min",""+t),this.valueLength.setAttribute("max",""+e),this}setValueLabel(t){let e=this.querySelector(".fanciful-label");return e.setAttribute("data-token-lang-inner_text",t),e.innerText=Z4MessageFactory.get(t),this}setHorizontal(){let t=this.querySelector(".fanciful-container");return t.classList.remove("fanciful-container-vertical"),t.classList.add("fanciful-container-horizontal"),this}setVertical(){let t=this.querySelector(".fanciful-container");return t.classList.add("fanciful-container-vertical"),t.classList.remove("fanciful-container-horizontal"),this}setValue(t){return this.fancifulValue=t,this.uniformCheck.checked=this.fancifulValue.isUniformSign(),this.constantUI.setSign(this.fancifulValue.getConstantSign()),this.constantUI.setValue(this.fancifulValue.getConstantValue()),this.setUniformSign(this.fancifulValue.getConstantSign()),this.randomUI.setSign(this.fancifulValue.getRandomSign()),this.setRandom(this.fancifulValue.getRandomValue()),this.proportionalUI.setSign(this.fancifulValue.getProportionalSign()),this.proportionalUI.setValue(this.fancifulValue.getProportionalValue()),this.setUI(),this}setUI(){this.selector.forEach((t=>{this.querySelector(".fanciful-label").classList.remove(t),this.querySelector(".form-check").classList.remove(t),this.querySelector(".fanciful-container").classList.remove(t)})),this.selector=new Array("cv-"+this.constantVisible,"rv-"+this.randomVisible,"pv-"+this.proportionalVisible,"csv-"+this.constantSignVisible,"rsv-"+this.randomSignVisible,"psv-"+this.proportionalSignVisible,"u-"+this.uniformCheck.checked),this.selector.forEach((t=>{this.querySelector(".fanciful-label").classList.add(t),this.querySelector(".form-check").classList.add(t),this.querySelector(".fanciful-container").classList.add(t)}))}setUniformSign(t){let e=null;e=t===Z4Sign.POSITIVE?"positive":t===Z4Sign.NEGATIVE?"negative":t===Z4Sign.RANDOM?"random":"alternate",this.toggleUniform.setAttribute("data-value",e),this.toggleUniformImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4sign_"+e+".svg")}getUniformSign(){switch(this.toggleUniform.getAttribute("data-value")){case"positive":return Z4Sign.POSITIVE;case"negative":return Z4Sign.NEGATIVE;case"random":return Z4Sign.RANDOM;case"alternate":return Z4Sign.alternate();default:return null}}setRandom(t){let e=null;t.isClassic()?e="classic":t.isBezier()?e="bezier":t.isPolyline()?e="polyline":t.isStepped()&&(e="stepped"),this.toggleRandom.setAttribute("data-value",e),this.toggleRandomImg.setAttribute("src",Z4FancifulValueUI.PATH+"z4randomvalue_"+e+".svg"),this.randomUI.setValue(t.getValue()),this.querySelector(".divider-length").style.display="classic"===e?"none":"block",this.querySelector(".container-length").style.display="classic"===e?"none":"block",this.valueLength.value=""+t.getLength()}getRandom(){switch(this.toggleRandom.getAttribute("data-value")){case"classic":return Z4RandomValue.classic(this.randomUI.getValue());case"bezier":return Z4RandomValue.bezier(this.randomUI.getValue(),this.valueLength.valueAsNumber);case"polyline":return Z4RandomValue.polyline(this.randomUI.getValue(),this.valueLength.valueAsNumber);case"stepped":return Z4RandomValue.stepped(this.randomUI.getValue(),this.valueLength.valueAsNumber);default:return null}}getValue(){return this.fancifulValue}}class Z4Lighting{static NONE=new Z4Lighting;static LIGTHED=new Z4Lighting;static DARKENED=new Z4Lighting;constructor(){}}class Z4Progression{static SPATIAL=new Z4Progression;static TEMPORAL=new Z4Progression;static RELATIVE_TO_PATH=new Z4Progression;static RANDOM=new Z4Progression;constructor(){}}class Z4AbstractColor{a=0;r=0;g=0;b=0;argb=0;hex=null;constructor(t,e,i,o){this.a=t,this.r=e,this.g=i,this.b=o,this.init()}init(){return this.argb=this.a<<24|this.r<<16|this.g<<8|this.b,this.hex="#"+new Number(this.r).toString(16).padStart(2,"0")+new Number(this.g).toString(16).padStart(2,"0")+new Number(this.b).toString(16).padStart(2,"0")+new Number(this.a).toString(16).padStart(2,"0"),this}getComponents(){return new Array(this.a,this.r,this.g,this.b)}getARGB(){return this.argb}getHEX(){return this.hex}set(t){return this.a=t>>>24&255,this.r=t>>>16&255,this.g=t>>>8&255,this.b=255&t,this.init()}gray(){let t=parseInt(.21*this.r+.71*this.g+.08*this.b);return this.r=t,this.g=t,this.b=t,this.init()}negative(){return this.r=255-this.r,this.g=255-this.g,this.b=255-this.b,this.init()}lighted(t){return this.r=parseInt((255-this.r)*t+this.r),this.g=parseInt((255-this.g)*t+this.g),this.b=parseInt((255-this.b)*t+this.b),this.init()}darkened(t){return t=1-t,this.r=parseInt(t*this.r),this.g=parseInt(t*this.g),this.b=parseInt(t*this.b),this.init()}}class Z4Color extends Z4AbstractColor{constructor(t,e,i,o){super(t,e,i,o)}static fromARGB(t){return new Z4Color(t>>>24&255,t>>>16&255,t>>>8&255,255&t)}static fromHEX(t,e){let i=new RegExp("^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$","i").exec(t);return new Z4Color(e,parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16))}static fromZ4AbstractColor(t){return Z4Color.fromARGB(t.getARGB())}static fromZ4AbstractColors(t,e,i){let o=t.getComponents(),s=e.getComponents();return new Z4Color(parseInt((s[0]-o[0])*i+o[0]),parseInt((s[1]-o[1])*i+o[1]),parseInt((s[2]-o[2])*i+o[2]),parseInt((s[3]-o[3])*i+o[3]))}}class Z4StopColor extends Z4AbstractColor{position=0;constructor(t,e,i,o,s){super(t,e,i,o),this.position=s}getPosition(){return this.position}setPosition(t){return this.position=t,this}static fromARGB(t,e){return new Z4StopColor(t>>>24&255,t>>>16&255,t>>>8&255,255&t,e)}static fromHEX(t,e,i){let o=new RegExp("^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$","i").exec(t);return new Z4StopColor(e,parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16),i)}static fromZ4AbstractColor(t,e){return Z4StopColor.fromARGB(t.getARGB(),e)}}class Z4AbstractGradientColor{z4StopColors=new Array;ripple=0;mirrored=!1;constructor(){this.z4StopColors.push(new Z4StopColor(255,255,255,255,0)),this.z4StopColors.push(new Z4StopColor(255,0,0,0,1))}getComponents(){return this.z4StopColors}addOrUpdateColor(t,e){let i=this.z4StopColors.find(((e,i,o)=>e.getPosition()===t));return i?i.set(e):this.z4StopColors.push(Z4StopColor.fromARGB(e,t)),this}generateColor(t){return this.addOrUpdateColor(t,this.getZ4ColorAt(t,!1,!1).getARGB())}removeColor(t){return this.z4StopColors=this.z4StopColors.filter(((e,i,o)=>e.getPosition()!==t)),this}move(t,e){let i=this.z4StopColors.find(((e,i,o)=>e.getPosition()===t));return i&&0!==t&&1!==t&&0!==e&&1!==e&&i.setPosition(e),this}setRipple(t){return this.ripple=t,this}getRipple(){return this.ripple}setMirrored(t){return this.mirrored=t,this}isMirrored(){return this.mirrored}negative(){return this.z4StopColors.forEach((t=>t.negative())),this}inverted(){return this.z4StopColors.forEach((t=>t.setPosition(1-t.getPosition()))),this}getZ4ColorAt(t,e,i){if(Z4Setting.isLiteMode())return this.z4StopColors.find(((t,e,i)=>1===t.getPosition()));if(Z4Setting.isStandardMode()||Z4Setting.isProMode()){i&&this.mirrored&&(t=2*(t<.5?t:1-t)),e&&0!==this.ripple&&(t=Z4Math.ripple(t,0,1,this.ripple));let o=t,s=this.z4StopColors.filter(((t,e,i)=>1===o?t.getPosition()<o:t.getPosition()<=o)).reduce(((t,e,i,o)=>t&&t.getPosition()>e.getPosition()?t:e)),r=this.z4StopColors.filter(((t,e,i)=>0===o?t.getPosition()>o:t.getPosition()>=o)).reduce(((t,e,i,o)=>t&&t.getPosition()<e.getPosition()?t:e));if(s===r)return s;{let e=(t-s.getPosition())/(r.getPosition()-s.getPosition());return Z4Color.fromZ4AbstractColors(s,r,e)}}return null}getLinearGradient(t,e,i,o,s){let r=t.createLinearGradient(e,i,o,s);return this.z4StopColors.forEach(((t,e,i)=>r.addColorStop(t.getPosition(),t.getHEX()))),r}getRadialGradient(t,e,i,o,s,r,n){let a=t.createRadialGradient(e,i,o,s,r,n);return this.z4StopColors.forEach(((t,e,i)=>a.addColorStop(t.getPosition(),t.getHEX()))),a}getConicGradient(t,e,i,o){let s=t.createConicGradient(o,e,i);return this.z4StopColors.forEach(((t,e,i)=>s.addColorStop(t.getPosition(),t.getHEX()))),s}}class Z4GradientColor extends Z4AbstractGradientColor{constructor(){super()}static fromZ4AbstractGradientColor(t){let e=new Z4GradientColor;return t.getComponents().forEach((t=>e.addOrUpdateColor(t.getPosition(),t.getARGB()))),e}static fromZ4AbstractGradientColors(t,e,i){let o=new Z4GradientColor;return t.getComponents().forEach((t=>{let s=e.getZ4ColorAt(t.getPosition(),!1,!1),r=Z4Color.fromZ4AbstractColors(t,s,i);o.addOrUpdateColor(t.getPosition(),r.getARGB())})),o.setRipple(t.getRipple()).setMirrored(t.isMirrored())}}class Z4StopGradientColor extends Z4AbstractGradientColor{position=0;constructor(t){super(),this.position=t}getPosition(){return this.position}setPosition(t){return this.position=t,this}static fromZ4AbstractGradientColor(t,e){let i=new Z4StopGradientColor(e);return t.getComponents().forEach((t=>i.addOrUpdateColor(t.getPosition(),t.getARGB()))),i.setRipple(t.getRipple()).setMirrored(t.isMirrored())}}class Z4TemporalColor{z4StopGradientColors=new Array;ripple=0;mirrored=!1;constructor(){this.z4StopGradientColors.push(new Z4StopGradientColor(0)),this.z4StopGradientColors.push(new Z4StopGradientColor(1))}getComponents(){return this.z4StopGradientColors}addOrUpdateColor(t,e,i){if(!this.z4StopGradientColors.find(((e,i,o)=>e.getPosition()===t))){let e=this.getZ4GradientColorAt(t,!1,!1);this.z4StopGradientColors.push(Z4StopGradientColor.fromZ4AbstractGradientColor(e,t))}return this.z4StopGradientColors.forEach((o=>{if(o.getPosition()!==t){o.getComponents().find(((t,i,o)=>t.getPosition()===e))||o.generateColor(e)}else o.addOrUpdateColor(e,i)})),this}generateColor(t,e){return-1!==t?this.addOrUpdateColor(t,e,this.getZ4ColorAt(t,e,!1,!1).getARGB()):(-1!==e&&this.z4StopGradientColors.forEach((t=>t.generateColor(e))),this)}removeColor(t,e){return 0!==t&&1!==t&&(this.z4StopGradientColors=this.z4StopGradientColors.filter(((e,i,o)=>e.getPosition()!==t))),0!==e&&1!==e&&this.z4StopGradientColors.forEach((t=>t.removeColor(e))),this}move(t,e,i,o){let s=this.z4StopGradientColors.find(((e,i,o)=>e.getPosition()===t));return s&&0!==t&&1!==t&&0!==e&&1!==e&&s.setPosition(e),this.z4StopGradientColors.forEach((t=>t.move(i,o))),this}setRipple(t,e){return this.ripple=t,this.z4StopGradientColors.forEach((t=>t.setRipple(e))),this}getTemporalRipple(){return this.ripple}getSpatialRipple(){return this.z4StopGradientColors[0].getRipple()}setMirrored(t,e){return this.mirrored=t,this.z4StopGradientColors.forEach((t=>t.setMirrored(e))),this}isTemporalyMirrored(){return this.mirrored}isSpatialyMirrored(){return this.z4StopGradientColors[0].isMirrored()}negative(){return this.z4StopGradientColors.forEach((t=>t.negative())),this}inverted(t,e){return t&&this.z4StopGradientColors.forEach((t=>t.setPosition(1-t.getPosition()))),e&&this.z4StopGradientColors.forEach((t=>t.inverted())),this}getZ4GradientColorAt(t,e,i){if(Z4Setting.isLiteMode()||Z4Setting.isStandardMode())return this.z4StopGradientColors.find(((t,e,i)=>0===t.getPosition()));if(Z4Setting.isProMode()){i&&this.mirrored&&(t=2*(t<.5?t:1-t)),e&&0!==this.ripple&&(t=Z4Math.ripple(t,0,1,this.ripple));let o=t,s=this.z4StopGradientColors.filter(((t,e,i)=>1===o?t.getPosition()<o:t.getPosition()<=o)).reduce(((t,e,i,o)=>t&&t.getPosition()>e.getPosition()?t:e)),r=this.z4StopGradientColors.filter(((t,e,i)=>0===o?t.getPosition()>o:t.getPosition()>=o)).reduce(((t,e,i,o)=>t&&t.getPosition()<e.getPosition()?t:e));if(s===r)return s;{let t=(o-s.getPosition())/(r.getPosition()-s.getPosition());return Z4GradientColor.fromZ4AbstractGradientColors(s,r,t)}}return null}getZ4ColorAt(t,e,i,o){return Z4Setting.isLiteMode()?this.getZ4GradientColorAt(0,!1,!1).getZ4ColorAt(1,!1,!1):Z4Setting.isStandardMode()?this.getZ4GradientColorAt(0,!1,!1).getZ4ColorAt(e,i,o):Z4Setting.isProMode()?this.getZ4GradientColorAt(t,i,o).getZ4ColorAt(e,i,o):null}}class Z4ColorUI extends Z4ComponentUI{color=this.querySelector(".form-control-color");formRangeLabel=this.querySelector(".form-range-label");formRange=this.querySelector(".form-range");static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4ColorUI.html");constructor(){super(Z4ColorUI.UI),this.querySelector(".gray").onclick=t=>(this.setZ4Color(this.getZ4Color().gray()),this.onchange(this.getZ4Color()),null),this.querySelector(".negative").onclick=t=>(this.setZ4Color(this.getZ4Color().negative()),this.onchange(this.getZ4Color()),null),this.color.oninput=t=>(this.oninput(this.getZ4Color()),null),this.color.onchange=t=>(this.onchange(this.getZ4Color()),null),this.formRange.oninput=t=>(this.formRangeLabel.innerText=this.formRange.value,this.oninput(this.getZ4Color()),null),this.formRange.onchange=t=>(this.formRangeLabel.innerText=this.formRange.value,this.onchange(this.getZ4Color()),null)}setColorLabel(t){let e=this.querySelector(".color-label");return e.setAttribute("data-token-lang-inner_text",t),e.innerText=Z4MessageFactory.get(t),this}setZ4Color(t){return this.color.value=t.getHEX().substring(0,7),this.formRange.valueAsNumber=t.getComponents()[0],this.formRangeLabel.innerText=this.formRange.value,this}getZ4Color(){return Z4Color.fromHEX(this.color.value,this.formRange.valueAsNumber)}}class Z4GradientColorUI extends Z4ComponentUI{canvas=this.querySelector(".canvas");ctx=this.canvas.getContext("2d");chessboard=this.ctx.createPattern(Z4ImageFactory.get("CHESSBOARD"),"repeat");sliders=this.querySelector(".sliders");formRangeLabel=this.querySelector(".form-range-label");mirroredCheck=this.querySelector(".mirrored-check");formRange=this.querySelector(".form-range");del=document.createElement("button");z4ColorUI=new Z4ColorUI;key=(new Date).getTime()+"_"+parseInt(1e3*Math.random());gradientColor=new Z4GradientColor;devicePixelRatioListener=null;mouseDown=!1;static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4GradientColorUI.html");static WIDTH=500;static HEIGHT=50;constructor(){super(Z4GradientColorUI.UI),this.initDevicePixelRatio(),this.querySelector(".gradient-inverted").onclick=t=>(this.setZ4GradientColor(this.gradientColor.inverted()),this.onchange(this.gradientColor),null),this.querySelector(".gradient-negative").onclick=t=>(this.setZ4GradientColor(this.gradientColor.negative()),this.onchange(this.gradientColor),null),this.querySelector(".gradient-guided-tour").onclick=t=>(Z4GradientColorGuidedTourUI.show(),null),this.canvas.style.border="1px dashed gray",this.canvas.style.width=Z4GradientColorUI.WIDTH+"px",this.canvas.style.height=Z4GradientColorUI.HEIGHT+"px",this.sliders.onmousemove=t=>{this.sliders.style.cursor="default";let e=t.clientX-this.sliders.getBoundingClientRect().left-8,i=Z4GradientColorUI.WIDTH/(this.gradientColor.isMirrored()?2:1);if(e<i){let t=e/i;this.gradientColor.getComponents().every(((e,i,o)=>Math.abs(t-e.getPosition())>.05))&&(this.sliders.style.cursor="pointer")}return null},Z4Loader.touch?this.sliders.ontouchstart=t=>(this.addColor(t.changedTouches[0].clientX),null):this.sliders.onmousedown=t=>(this.addColor(t.clientX),null),this.mirroredCheck.id="mirrored_"+(new Date).getTime()+"_"+parseInt(1e3*Math.random()),this.querySelector(".mirrored-label").setAttribute("for",this.mirroredCheck.id),this.mirroredCheck.onchange=t=>(this.gradientColor.setMirrored(this.mirroredCheck.checked),this.configureSliders(-1),this.drawCanvas(),this.onchange(this.gradientColor),null),this.formRange.oninput=t=>(this.formRangeLabel.innerText=this.formRange.value,this.gradientColor.setRipple(this.formRange.valueAsNumber),this.drawCanvas(),this.oninput(this.gradientColor),null),this.formRange.onchange=t=>(this.formRangeLabel.innerText=this.formRange.value,this.gradientColor.setRipple(this.formRange.valueAsNumber),this.drawCanvas(),this.onchange(this.gradientColor),null),this.z4ColorUI.appendTo(this.querySelector(".canvas-container")),this.z4ColorUI.oninput=t=>{let e=this.querySelector(".sliders .form-check-input:checked");this.gradientColor.addOrUpdateColor(parseFloat(e.value),t.getARGB()),this.drawCanvas(),this.oninput(this.gradientColor)},this.z4ColorUI.onchange=t=>{let e=this.querySelector(".sliders .form-check-input:checked");this.gradientColor.addOrUpdateColor(parseFloat(e.value),t.getARGB()),this.drawCanvas(),this.onchange(this.gradientColor)},this.del.setAttribute("class","dropdown-item delete-color"),this.del.setAttribute("type","button"),this.del.setAttribute("data-token-lang-inner_text","DELETE"),this.del.innerText=Z4MessageFactory.get("DELETE"),this.del.onclick=t=>(Z4ModalMessageUI.showQuestion(Z4MessageFactory.get("TITLE"),Z4MessageFactory.get("DELETE_COLOR_MESSAGE"),(()=>{let t=this.querySelector(".sliders .form-check-input:checked");this.gradientColor.removeColor(parseFloat(t.value)),this.configureSliders(-1),this.drawCanvas(),this.onchange(this.gradientColor)}),(()=>{}),null,null),null),this.querySelector(".negative").parentElement.appendChild(document.createElement("li")).appendChild(this.del),this.setZ4GradientColor(this.gradientColor)}initDevicePixelRatio(){window.matchMedia&&(this.devicePixelRatioListener=()=>{this.drawCanvas(),this.addDevicePixelRatioListener()},this.addDevicePixelRatioListener())}addDevicePixelRatioListener(){let t=new Object;t.once=!0,window.matchMedia("(resolution: "+window.devicePixelRatio+"dppx)").addEventListener("change",this.devicePixelRatioListener,t)}addColor(t){t-=this.sliders.getBoundingClientRect().left+8;let e=Z4GradientColorUI.WIDTH/(this.gradientColor.isMirrored()?2:1);if(t<e){let i=t/e;this.gradientColor.getComponents().every(((t,e,o)=>Math.abs(i-t.getPosition())>.05))&&(this.gradientColor.generateColor(i),this.configureSliders(this.gradientColor.getComponents().length-1),this.drawCanvas(),this.onchange(this.gradientColor))}}setGradientColorLabel(t){let e=this.querySelector(".gradient-color-label");return e.setAttribute("data-token-lang-inner_text",t),e.innerText=Z4MessageFactory.get(t),this}setColorLabel(t){return this.z4ColorUI.setColorLabel(t),this}getZ4GradientColor(){return this.gradientColor}setZ4GradientColor(t){return this.gradientColor=t,this.mirroredCheck.checked=this.gradientColor.isMirrored(),this.formRange.valueAsNumber=this.gradientColor.getRipple(),this.formRangeLabel.innerText=this.formRange.value,this.configureSliders(-1),this.drawCanvas(),this}configureSliders(t){let e=Z4GradientColorUI.WIDTH/(this.gradientColor.isMirrored()?2:1);this.sliders.innerHTML="",this.gradientColor.getComponents().forEach(((i,o,s)=>{let r=i.getPosition(),n=e*r-16*o,a=document.createElement("input");a.setAttribute("class","form-check-input"),a.setAttribute("type","radio"),a.setAttribute("name","colors_"+this.key),a.setAttribute("value",""+r),a.setAttribute("style",(0!==o&&1!==o?"cursor:ew-resize;":"")+"position:relative;left:"+n+"px"),a.onchange=t=>(this.z4ColorUI.setZ4Color(i),0===o||1===o?this.del.setAttribute("disabled",""):this.del.removeAttribute("disabled"),null),Z4Loader.touch?(a.ontouchstart=t=>this.manageEvent(t,!0,!1,o,a,t.changedTouches[0].clientX),a.ontouchmove=t=>this.manageEvent(t,this.mouseDown,!0,o,a,t.changedTouches[0].clientX),a.ontouchend=t=>this.manageEvent(t,!1,!1,o,a,t.changedTouches[0].clientX),a.ontouchcancel=t=>this.manageEvent(t,!1,!1,o,a,t.changedTouches[0].clientX)):(a.onmousedown=t=>this.manageEvent(t,!0,!1,o,a,t.clientX),a.onmousemove=t=>this.manageEvent(t,this.mouseDown,!0,o,a,t.clientX),a.onmouseup=t=>this.manageEvent(t,!1,!1,o,a,t.clientX),a.onmouseleave=t=>this.manageEvent(t,!1,!1,o,a,t.clientX)),-1!==t&&o===t?(a.setAttribute("checked",""),this.z4ColorUI.setZ4Color(i),this.del.removeAttribute("disabled")):-1===t&&0===o&&(a.setAttribute("checked",""),this.z4ColorUI.setZ4Color(i),this.del.setAttribute("disabled","")),this.sliders.appendChild(a)}))}manageEvent(t,e,i,o,s,r){return t.stopPropagation(),this.mouseDown&&!e&&this.onchange(this.gradientColor),this.mouseDown=e,i&&this.mouseDown&&0!==o&&1!==o&&this.moveColor(s,o,r),null}moveColor(t,e,i){i-=this.sliders.getBoundingClientRect().left+8;let o=Z4GradientColorUI.WIDTH/(this.gradientColor.isMirrored()?2:1);if(i<o){let s=i/o;if(this.gradientColor.getComponents().every(((t,i,o)=>i===e||Math.abs(s-t.getPosition())>.05))){let i=parseFloat(t.value),r=o*s-16*e;t.setAttribute("value",""+s),t.style.left=r+"px",this.gradientColor.move(i,s),this.drawCanvas(),this.oninput(this.gradientColor)}}}drawCanvas(){this.canvas.width=Math.floor(Z4GradientColorUI.WIDTH*window.devicePixelRatio),this.canvas.height=Math.floor(Z4GradientColorUI.HEIGHT*window.devicePixelRatio);let t=new OffscreenCanvas(Z4GradientColorUI.WIDTH,Z4GradientColorUI.HEIGHT),e=t.getContext("2d");for(let t=0;t<Z4GradientColorUI.WIDTH;t++)e.fillStyle=this.gradientColor.getZ4ColorAt(t/Z4GradientColorUI.WIDTH,!0,!0).getHEX(),e.fillRect(t,0,1,Z4GradientColorUI.HEIGHT);this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.fillStyle=this.chessboard,this.ctx.fillRect(0,0,Z4GradientColorUI.WIDTH,Z4GradientColorUI.HEIGHT),this.ctx.drawImage(t,0,0),this.ctx.restore()}}class Z4GradientColorGuidedTourUI extends Z4GradientColorUI{options=new Object;element1=null;element2=null;event=null;message=null;constructor(){super(),this.querySelector(".dropdown-divider").remove(),this.querySelector(".gradient-guided-tour").remove(),this.options.once=!0,this.doStep(0)}static show(){Z4ModalMessageUI.showInfo(Z4MessageFactory.get("TITLE"),"",(()=>{document.querySelector(".modal-dialog").classList.remove("modal-lg"),document.querySelector(".modal-message").innerHTML="",document.querySelector(".modal-dialog .modal-footer").innerHTML=""}));let t=document.createElement("label");t.className="z4-guided-tour",document.querySelector(".modal-dialog").classList.add("modal-lg"),document.querySelector(".modal-dialog .modal-footer").insertBefore(t,document.querySelector(".modal-dialog .modal-footer button")),(new Z4GradientColorGuidedTourUI).appendTo(document.querySelector(".modal-message"))}doStep(t){switch(t){case 0:this.element1=this.element2=this.querySelector(".form-check-input[value='1']"),this.event="change",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_SELECT_COLOR");break;case 1:this.element1=this.element2=this.querySelector(".form-control-color"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_EDIT_COMPONENTS1");break;case 2:this.element1=this.querySelector(".dropdown-toggle-split"),this.element2=this.querySelector(".dropdown-menu .form-range"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_EDIT_OPACITY");break;case 3:this.element1=this.element2=this.querySelector(".sliders"),this.event=Z4Loader.touch?"touchstart":"mousedown",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_ADD_COLOR");break;case 4:this.element1=this.element2=this.querySelector(".form-control-color"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_EDIT_COMPONENTS2");break;case 5:this.element1=this.element2=this.querySelector(".form-check-input:nth-child(3)"),this.event=Z4Loader.touch?"touchend":"mouseup",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_MOVE");break;case 6:this.element1=this.querySelector(".z4-dropdown-toggle-three-dots"),this.element2=this.querySelector(".gradient-inverted"),this.event="click",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_INVERT");break;case 7:this.element1=this.querySelector(".z4-dropdown-toggle-three-dots"),this.element2=this.querySelector(".gradient-negative"),this.event="click",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_NEGATIVIZE");break;case 8:this.element1=this.element2=this.querySelector(".mirrored-check"),this.event="change",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_MIRROR");break;case 9:this.element1=this.element2=this.querySelector(".form-range[step='0.01']"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_GRADIENT_ADD_RIPPLE");break;default:this.element1=null,this.message=Z4MessageFactory.get("GUIDED_TOUR_COMPLETED")}let e=document.querySelector(".modal-dialog .modal-footer label");this.element1?(this.element1.classList.add("z4-guided-tour"),this.element2.classList.add("z4-guided-tour"),this.element2.addEventListener(this.event,(e=>{this.element1.classList.remove("z4-guided-tour"),this.element2.classList.remove("z4-guided-tour"),this.doStep(t+1)}),this.options)):e&&(e.className=""),e?e.innerText=this.message:console.log(this.message)}}class Z4TemporalColorUI extends Z4ComponentUI{canvas=this.querySelector(".canvas");ctx=this.canvas.getContext("2d");chessboard=this.ctx.createPattern(Z4ImageFactory.get("CHESSBOARD"),"repeat");sliders=this.querySelector(".sliders");temporalFormRangeLabel=this.querySelector(".temporal-form-range-label");spatialFormRangeLabel=this.querySelector(".spatial-form-range-label");temporalMirroredCheck=this.querySelector(".temporal-mirrored-check");spatialMirroredCheck=this.querySelector(".spatial-mirrored-check");temporalFormRange=this.querySelector(".form-range-temporal");spatialFormRange=this.querySelector(".form-range-spatial");del=document.createElement("button");z4ColorUI=new Z4ColorUI;key=(new Date).getTime()+"_"+parseInt(1e3*Math.random());temporalColor=new Z4TemporalColor;devicePixelRatioListener=null;mouseDown=!1;static UI=Z4HTMLFactory.get("giada/pizzapazza/color/ui/Z4TemporalColorUI.html");static WIDTH=500;static HEIGHT=200;constructor(){super(Z4TemporalColorUI.UI),this.initDevicePixelRatio(),this.querySelector(".temporal-inverted").onclick=t=>this.inverted(!0,!1),this.querySelector(".spatial-inverted").onclick=t=>this.inverted(!1,!0),this.querySelector(".temporal-negative").onclick=t=>(this.setZ4TemporalColor(this.temporalColor.negative()),this.onchange(this.temporalColor),null),this.querySelector(".temporal-guided-tour").onclick=t=>(Z4TemporalColorGuidedTourUI.show(),null),this.canvas.style.border="1px dashed gray",this.canvas.style.width=Z4TemporalColorUI.WIDTH+"px",this.canvas.style.height=Z4TemporalColorUI.HEIGHT+"px",this.canvas.onmousemove=t=>{this.canvas.style.cursor="default";let e=Z4TemporalColorUI.WIDTH/(this.temporalColor.isTemporalyMirrored()?2:1),i=Z4TemporalColorUI.HEIGHT/(this.temporalColor.isSpatialyMirrored()?2:1),o=this.temporalColor.isSpatialyMirrored()?Z4TemporalColorUI.HEIGHT/2:0,s=t.clientX-this.canvas.getBoundingClientRect().left,r=t.clientY-this.canvas.getBoundingClientRect().top;if(s<e&&o<r&&r<o+i){let t=s/e,n=(i-r+o)/i,a=this.temporalColor.getComponents().every(((e,i,o)=>Math.abs(t-e.getPosition())>.05)),l=this.temporalColor.getComponents()[0].getComponents().every(((t,e,i)=>Math.abs(n-t.getPosition())>.1));a&&l&&(this.canvas.style.cursor="pointer")}return null},Z4Loader.touch?this.canvas.ontouchstart=t=>(this.addColor(t.changedTouches[0].clientX,t.changedTouches[0].clientY),null):this.canvas.onmousedown=t=>(this.addColor(t.clientX,t.clientY),null);let t=t=>(this.temporalColor.setMirrored(this.temporalMirroredCheck.checked,this.spatialMirroredCheck.checked),this.configureSliders(-1,-1),this.drawCanvas(1),this.onchange(this.temporalColor),null);this.temporalMirroredCheck.onchange=t,this.spatialMirroredCheck.onchange=t,this.temporalMirroredCheck.id="mirrored_"+(new Date).getTime()+"_"+parseInt(1e3*Math.random()),this.querySelector(".temporal-mirrored-label").setAttribute("for",this.temporalMirroredCheck.id),this.spatialMirroredCheck.id="mirrored_"+(new Date).getTime()+"_"+parseInt(1e3*Math.random()),this.querySelector(".spatial-mirrored-label").setAttribute("for",this.spatialMirroredCheck.id),this.temporalFormRange.oninput=t=>this.setRipple(5),this.spatialFormRange.oninput=t=>this.setRipple(5),this.temporalFormRange.onchange=t=>this.setRipple(1),this.spatialFormRange.onchange=t=>this.setRipple(1),this.z4ColorUI.appendTo(this.querySelector(".canvas-container")),this.z4ColorUI.oninput=t=>{let e=this.querySelector(".sliders .form-check-input:checked");this.temporalColor.addOrUpdateColor(parseFloat(e.getAttribute("T")),parseFloat(e.getAttribute("S")),t.getARGB()),this.drawCanvas(5),this.oninput(this.temporalColor)},this.z4ColorUI.onchange=t=>{let e=this.querySelector(".sliders .form-check-input:checked");this.temporalColor.addOrUpdateColor(parseFloat(e.getAttribute("T")),parseFloat(e.getAttribute("S")),t.getARGB()),this.drawCanvas(1),this.onchange(this.temporalColor)},this.del.setAttribute("class","dropdown-item delete-color"),this.del.setAttribute("type","button"),this.del.setAttribute("data-token-lang-inner_text","DELETE"),this.del.innerText=Z4MessageFactory.get("DELETE"),this.del.onclick=t=>(Z4ModalMessageUI.showQuestion(Z4MessageFactory.get("TITLE"),Z4MessageFactory.get("DELETE_COLOR_MESSAGE"),(()=>{let t=this.querySelector(".sliders .form-check-input:checked");this.temporalColor.removeColor(parseFloat(t.getAttribute("T")),parseFloat(t.getAttribute("S"))),this.configureSliders(-1,-1),this.drawCanvas(1),this.onchange(this.temporalColor)}),(()=>{}),null,null),null),this.querySelector(".negative").parentElement.appendChild(document.createElement("li")).appendChild(this.del),this.setZ4TemporalColor(this.temporalColor)}initDevicePixelRatio(){window.matchMedia&&(this.devicePixelRatioListener=()=>{this.drawCanvas(1),this.addDevicePixelRatioListener()},this.addDevicePixelRatioListener())}addDevicePixelRatioListener(){let t=new Object;t.once=!0,window.matchMedia("(resolution: "+window.devicePixelRatio+"dppx)").addEventListener("change",this.devicePixelRatioListener,t)}addColor(t,e){t-=this.canvas.getBoundingClientRect().left,e-=this.canvas.getBoundingClientRect().top;let i=Z4TemporalColorUI.WIDTH/(this.temporalColor.isTemporalyMirrored()?2:1),o=Z4TemporalColorUI.HEIGHT/(this.temporalColor.isSpatialyMirrored()?2:1),s=this.temporalColor.isSpatialyMirrored()?Z4TemporalColorUI.HEIGHT/2:0;if(t<i&&s<e&&e<s+o){let r=t/i,n=(o-e+s)/o,a=this.temporalColor.getComponents().every(((t,e,i)=>Math.abs(r-t.getPosition())>.05)),l=this.temporalColor.getComponents()[0].getComponents().every(((t,e,i)=>Math.abs(n-t.getPosition())>.1));a&&l&&(this.temporalColor.generateColor(r,n),this.configureSliders(this.temporalColor.getComponents().length-1,this.temporalColor.getComponents()[0].getComponents().length-1),this.drawCanvas(1),this.onchange(this.temporalColor))}}setRipple(t){return this.temporalFormRangeLabel.innerText=this.temporalFormRange.value,this.spatialFormRangeLabel.innerText=this.spatialFormRange.value,this.temporalColor.setRipple(this.temporalFormRange.valueAsNumber,this.spatialFormRange.valueAsNumber),this.drawCanvas(t),1===t?this.onchange(this.temporalColor):this.oninput(this.temporalColor),null}inverted(t,e){return this.setZ4TemporalColor(this.temporalColor.inverted(t,e)),this.onchange(this.temporalColor),null}setTemporalColorLabel(t){let e=this.querySelector(".temporal-color-label");return e.setAttribute("data-token-lang-inner_text",t),e.innerText=Z4MessageFactory.get(t),this}setColorLabel(t){return this.z4ColorUI.setColorLabel(t),this}getZ4TemporalColor(){return this.temporalColor}setZ4TemporalColor(t){return this.temporalColor=t,this.temporalMirroredCheck.checked=this.temporalColor.isTemporalyMirrored(),this.spatialMirroredCheck.checked=this.temporalColor.isSpatialyMirrored(),this.temporalFormRange.valueAsNumber=this.temporalColor.getTemporalRipple(),this.temporalFormRangeLabel.innerText=this.temporalFormRange.value,this.spatialFormRange.valueAsNumber=this.temporalColor.getSpatialRipple(),this.spatialFormRangeLabel.innerText=this.spatialFormRange.value,this.configureSliders(-1,-1),this.drawCanvas(1),this}configureSliders(t,e){let i=Z4TemporalColorUI.WIDTH/(this.temporalColor.isTemporalyMirrored()?2:1),o=Z4TemporalColorUI.HEIGHT/(this.temporalColor.isSpatialyMirrored()?2:1),s=this.temporalColor.isSpatialyMirrored()?Z4TemporalColorUI.HEIGHT/2:0;this.sliders.innerHTML="",this.temporalColor.getComponents().forEach(((r,n,a)=>{let l=r.getPosition(),h=i*l-8;r.getComponents().forEach(((i,r,a)=>{let c=i.getPosition(),u=s-8+o*(1-c)-16*(r+a.length*n),g=document.createElement("input");g.setAttribute("class","form-check-input"),g.setAttribute("type","radio"),g.setAttribute("name","colors_"+this.key),g.setAttribute("value",l+"-"+c),g.setAttribute("T",""+l),g.setAttribute("S",""+c),g.setAttribute("style","margin-top:0px;position:relative;left:"+h+"px;top:"+u+"px"),0!==n&&1!==n&&0!==r&&1!==r?g.style.cursor="move":0!==n&&1!==n?g.style.cursor="ew-resize":0!==r&&1!==r&&(g.style.cursor="ns-resize"),g.onchange=t=>(this.z4ColorUI.setZ4Color(i),0!==n&&1!==n||0!==r&&1!==r?this.del.removeAttribute("disabled"):this.del.setAttribute("disabled",""),null),Z4Loader.touch?(g.ontouchstart=t=>this.manageEvent(t,!0,!1,n,r,g,t.changedTouches[0].clientX,t.changedTouches[0].clientY),g.ontouchmove=t=>this.manageEvent(t,this.mouseDown,!0,n,r,g,t.changedTouches[0].clientX,t.changedTouches[0].clientY),g.ontouchend=t=>this.manageEvent(t,!1,!1,n,r,g,t.changedTouches[0].clientX,t.changedTouches[0].clientY),g.ontouchcancel=t=>this.manageEvent(t,!1,!1,n,r,g,t.changedTouches[0].clientX,t.changedTouches[0].clientY)):(g.onmousedown=t=>this.manageEvent(t,!0,!1,n,r,g,t.clientX,t.clientY),g.onmousemove=t=>this.manageEvent(t,this.mouseDown,!0,n,r,g,t.clientX,t.clientY),g.onmouseup=t=>this.manageEvent(t,!1,!1,n,r,g,t.clientX,t.clientY),g.onmouseleave=t=>this.manageEvent(t,!1,!1,n,r,g,t.clientX,t.clientY)),-1!==t&&-1!==e&&n===t&&r===e?(g.setAttribute("checked",""),this.z4ColorUI.setZ4Color(i),this.del.removeAttribute("disabled")):-1===t&&-1===e&&0===n&&0===r&&(g.setAttribute("checked",""),this.z4ColorUI.setZ4Color(i),this.del.setAttribute("disabled","")),this.sliders.appendChild(g)}))}))}manageEvent(t,e,i,o,s,r,n,a){return t.stopPropagation(),this.mouseDown&&!e&&(this.drawCanvas(1),this.onchange(this.temporalColor)),this.mouseDown=e,i&&this.mouseDown&&(0!==o&&1!==o||0!==s&&1!==s)&&this.moveColor(r,o,s,n,a),null}moveColor(t,e,i,o,s){o-=this.canvas.getBoundingClientRect().left,s-=this.canvas.getBoundingClientRect().top;let r=Z4TemporalColorUI.WIDTH/(this.temporalColor.isTemporalyMirrored()?2:1),n=Z4TemporalColorUI.HEIGHT/(this.temporalColor.isSpatialyMirrored()?2:1),a=this.temporalColor.isSpatialyMirrored()?Z4TemporalColorUI.HEIGHT/2:0,l=0!==e&&1!==e&&0!==i&&1!==i&&o<r&&a<s&&s<a+n,h=0!==e&&1!==e&&o<r,c=0!==i&&1!==i&&a<s&&s<a+n,u=o/r,g=(n-s+a)/n,d=this.temporalColor.getComponents().every(((t,i,o)=>i===e||Math.abs(u-t.getPosition())>.05)),m=this.temporalColor.getComponents()[0].getComponents().every(((t,e,o)=>e===i||Math.abs(g-t.getPosition())>.1)),p=parseFloat(t.getAttribute("T")),C=parseFloat(t.getAttribute("S")),S=r*u-8,Z=a-8+n*(1-g)-16*(i+this.temporalColor.getComponents()[0].getComponents().length*e);l?d&&m&&(this.move(t,p,C,u,g,S,Z,a,n),this.temporalColor.move(p,u,C,g),this.drawCanvas(5),this.oninput(this.temporalColor)):h?d&&(this.move(t,p,C,u,C,S,parseFloat(t.style.top.replace("px","")),a,n),this.temporalColor.move(p,u,-1,-1),this.drawCanvas(5),this.oninput(this.temporalColor)):c&&m&&(this.move(t,p,C,p,g,parseFloat(t.style.left.replace("px","")),Z,a,n),this.temporalColor.move(p,u,C,g),this.drawCanvas(5),this.oninput(this.temporalColor))}move(t,e,i,o,s,r,n,a,l){this.temporalColor.getComponents().forEach(((t,n,h)=>{let c=t.getPosition();t.getComponents().forEach(((t,h,u)=>{let g=t.getPosition();if(c===e||g===i){let t=this.querySelector(".sliders input[value='"+c+"-"+g+"']");if(0!==c&&1!==c&&c===e&&(t.setAttribute("value",o+"-"+g),t.setAttribute("T",""+o),t.style.left=r+"px"),0!==g&&1!==g&&g===i){let e=a-8+l*(1-s)-16*(h+u.length*n);t.setAttribute("value",c+"-"+s),t.setAttribute("S",""+s),t.style.top=e+"px"}}}))})),t.setAttribute("value",o+"-"+s),t.setAttribute("T",""+o),t.setAttribute("S",""+s),t.style.left=r+"px",t.style.top=n+"px"}drawCanvas(t){this.canvas.width=Math.floor(Z4TemporalColorUI.WIDTH*window.devicePixelRatio),this.canvas.height=Math.floor(Z4TemporalColorUI.HEIGHT*window.devicePixelRatio);let e=new OffscreenCanvas(Z4TemporalColorUI.WIDTH,Z4TemporalColorUI.HEIGHT),i=e.getContext("2d");for(let e=0;e<Z4TemporalColorUI.WIDTH;e+=t){let o=this.temporalColor.getZ4GradientColorAt(e/Z4TemporalColorUI.WIDTH,!0,!0);for(let s=0;s<Z4TemporalColorUI.HEIGHT;s+=t)i.fillStyle=o.getZ4ColorAt(s/Z4TemporalColorUI.HEIGHT,!0,!0).getHEX(),i.fillRect(e,Z4TemporalColorUI.HEIGHT-s-t,t,t)}this.ctx.save(),this.ctx.scale(window.devicePixelRatio,window.devicePixelRatio),this.ctx.fillStyle=this.chessboard,this.ctx.fillRect(0,0,Z4TemporalColorUI.WIDTH,Z4TemporalColorUI.HEIGHT),this.ctx.drawImage(e,0,0),this.ctx.restore()}}class Z4TemporalColorGuidedTourUI extends Z4TemporalColorUI{options=new Object;element1=null;element2=null;event=null;message=null;i=document.createElement("i");constructor(){super(),this.querySelector(".dropdown-divider").remove(),this.querySelector(".temporal-guided-tour").remove();let t=document.createElement("div");t.setAttribute("style","float:right"),this.querySelector(".canvas-container div div:nth-child(3)").appendChild(t),this.i.className="bi bi-arrow-left-circle",this.i.setAttribute("style","font-size:30px;border-radius:48px;position:relative;top:50px;padding:0px 5px;visibility:hidden"),t.appendChild(this.i),this.options.once=!0,this.doStep(0)}static show(){Z4ModalMessageUI.showInfo(Z4MessageFactory.get("TITLE"),"",(()=>{document.querySelector(".modal-dialog").classList.remove("modal-lg"),document.querySelector(".modal-message").innerHTML="",document.querySelector(".modal-dialog .modal-footer").innerHTML=""}));let t=document.createElement("label");t.className="z4-guided-tour",document.querySelector(".modal-dialog").classList.add("modal-lg"),document.querySelector(".modal-dialog .modal-footer").insertBefore(t,document.querySelector(".modal-dialog .modal-footer button")),(new Z4TemporalColorGuidedTourUI).appendTo(document.querySelector(".modal-message"))}doStep(t){switch(t){case 0:this.element1=this.element2=this.querySelector(".form-check-input[value='1-1']"),this.event="change",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_SELECT_COLOR");break;case 1:this.element1=this.element2=this.querySelector(".form-control-color"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_EDIT_COMPONENTS1");break;case 2:this.element1=this.querySelector(".dropdown-toggle-split"),this.element2=this.querySelector(".dropdown-menu .form-range"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_EDIT_OPACITY");break;case 3:this.i.style.visibility="visible",this.element1=this.querySelector(".bi-arrow-left-circle"),this.element2=this.querySelector(".canvas"),this.event=Z4Loader.touch?"touchstart":"mousedown",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_ADD_COLOR");break;case 4:this.i.style.visibility="hidden",this.element1=this.element2=this.querySelector(".form-control-color"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_EDIT_COMPONENTS2");break;case 5:this.element1=this.element2=this.querySelector(".form-check-input:nth-child(9)"),this.event=Z4Loader.touch?"touchend":"mouseup",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_MOVE");break;case 6:this.element1=this.querySelector(".z4-dropdown-toggle-three-dots"),this.element2=this.querySelector(".spatial-inverted"),this.event="click",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_INVERT_SPATIAL");break;case 7:this.element1=this.querySelector(".z4-dropdown-toggle-three-dots"),this.element2=this.querySelector(".temporal-inverted"),this.event="click",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_INVERT_TEMPORAL");break;case 8:this.element1=this.querySelector(".z4-dropdown-toggle-three-dots"),this.element2=this.querySelector(".temporal-negative"),this.event="click",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_NEGATIVIZE");break;case 9:this.element1=this.element2=this.querySelector(".temporal-mirrored-check"),this.event="change",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_MIRROR_TEMPORAL");break;case 10:this.element1=this.element2=this.querySelector(".spatial-mirrored-check"),this.event="change",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_MIRROR_SPATIAL");break;case 11:this.element1=this.element2=this.querySelector(".form-range-spatial"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_ADD_RIPPLE_SPATIAL");break;case 12:this.element1=this.element2=this.querySelector(".form-range-temporal"),this.event="input",this.message=Z4MessageFactory.get("GUIDED_TOUR_TEMPORAL_ADD_RIPPLE_TEMPORAL");break;default:this.element1=null,this.message=Z4MessageFactory.get("GUIDED_TOUR_COMPLETED")}let e=document.querySelector(".modal-dialog .modal-footer label");this.element1?(this.element1.classList.add("z4-guided-tour"),this.element2.classList.add("z4-guided-tour"),this.element2.addEventListener(this.event,(e=>{this.element1.classList.remove("z4-guided-tour"),this.element2.classList.remove("z4-guided-tour"),this.doStep(t+1)}),this.options)):e&&(e.className=""),e?e.innerText=this.message:console.log(this.message)}}class Z4Painter{draw(t,e,i){}getColor(t){return t}}class Z4ArrowPainter extends Z4Painter{bool=!1;draw(t,e,i){this.bool=!this.bool;let o=e.getIntensity()*e.getZ4Vector().getModule();return t.save(),t.lineWidth=1,t.strokeStyle=this.getColor("black"),t.beginPath(),t.arc(0,0,2,0,Z4Math.TWO_PI),t.stroke(),t.strokeStyle=this.getColor(this.bool?"blue":"red"),t.beginPath(),t.moveTo(0,0),t.lineTo(o,0),t.lineTo(o-5,-2.5),t.lineTo(o-5,2.5),t.lineTo(o,0),t.stroke(),t.restore(),this}}class Z4ClassicPainter extends Z4Painter{draw(t,e,i){return this}}class Z4Shape2DPainter extends Z4Painter{shape=Z4Shape2D.SQUARE;size=(new Z4FancifulValue).setConstant(Z4Sign.POSITIVE,50);shadowShiftX=new Z4FancifulValue;shadowShiftY=new Z4FancifulValue;shadowColor=new Z4Color(255,0,0,0);borderSize=new Z4FancifulValue;borderColor=new Z4Color(255,0,0,0);setShape2D(t){return this.shape=t,this}draw(t,e,i){if(e.isDrawBounds())this.drawBounds(t,e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.size.getConstantValue()));else{let o=e.getIntensity()*(e.isUseVectorModuleAsSize()?2*e.getZ4Vector().getModule():this.size.next(0));if(o<=0)return this;let s=e.getIntensity()*this.shadowShiftX.next(0),r=e.getIntensity()*this.shadowShiftY.next(0),n=e.getIntensity()*this.borderSize.next(0);(s||r)&&(t.save(),t.translate(s,r),this.drawPath(t,o+(n>0?n:0),this.shadowColor),t.restore()),n&&(t.save(),this.drawPath(t,o+n,this.borderColor),t.restore());let a=e.getColorPosition(),l=e.getLighting();if(-1===a)for(let e=o;e>0;e--)this.drawPath(t,e,i.getZ4ColorAt(e/o,!0,!0));else if(l===Z4Lighting.NONE)this.drawPath(t,o,i.getZ4ColorAt(a,!0,!0));else{let e=i.getZ4ColorAt(a,!0,!0);for(let i=o;i>0;i--)l===Z4Lighting.LIGTHED?this.drawPath(t,i,Z4Color.fromARGB(e.getARGB()).lighted(i/o)):l===Z4Lighting.DARKENED&&this.drawPath(t,i,Z4Color.fromARGB(e.getARGB()).darkened(i/o))}}return this}drawPath(t,e,i){t.save(),t.scale(e,e),t.fillStyle=i.getHEX(),t.fill(this.shape.getPath()),t.restore()}drawBounds(t,e){t.save(),t.scale(e,e),t.lineWidth=1/e,t.strokeStyle=this.getColor("gray"),t.stroke(this.shape.getPath()),t.strokeStyle=this.getColor("black"),t.translate(1/e,1/e),t.stroke(this.shape.getPath()),t.restore()}}class Z4NaturalFigurePainter extends Z4Painter{draw(t,e,i){return this}}class Z4CenteredFigurePainter extends Z4Painter{draw(t,e,i){return this}}class Z4Action{static START=new Z4Action;static CONTINUE=new Z4Action;static STOP=new Z4Action;constructor(){}}class Z4Rotation{static FIXED=new Z4Rotation;static CUMULATIVE=new Z4Rotation;static RELATIVE_TO_PATH=new Z4Rotation;constructor(){}}class Z4PointIterator{progression=Z4Progression.SPATIAL;temporalStepProgression=.1;lighting=Z4Lighting.NONE;rotation=new Z4FancifulValue;rotationMode=Z4Rotation.FIXED;z4Point=new Z4Point;P=new Object;hasNext=!1;rotationNext=0;constructor(){this.P.x=0,this.P.y=0}seProgression(t,e,i){return this.progression=t,this.temporalStepProgression=e,this.lighting=i,this}setRotation(t,e){return this.rotation=t,this.rotationMode=e,this}draw(t,e,i){}next(){}drawDemo(t,e,i){}nextRotation(t){let e=Z4Math.deg2rad(this.rotation.next(0));return this.rotationMode===Z4Rotation.FIXED?e:this.rotationMode===Z4Rotation.CUMULATIVE?(this.rotationNext+=e,this.rotationNext):this.rotationMode===Z4Rotation.RELATIVE_TO_PATH?e+t:0}nextSide(t,e){this.rotationMode===Z4Rotation.FIXED||this.rotationMode===Z4Rotation.CUMULATIVE?t.setSide(Z4Sign.POSITIVE):this.rotationMode===Z4Rotation.RELATIVE_TO_PATH&&t.setSide(e?e.direction(t.getZ4Vector()):Z4Sign.RANDOM)}getColor(t){return t}}class Z4Stamper extends Z4PointIterator{intensity=(new Z4FancifulValue).setConstant(Z4Sign.POSITIVE,15);multiplicity=(new Z4FancifulValue).setConstant(Z4Sign.POSITIVE,1);push=(new Z4FancifulValue).setConstant(Z4Sign.POSITIVE,0);currentMultiplicityCounter=0;currentMultiplicityTotal=0;currentPush=0;draw(t,e,i){return t===Z4Action.START&&(this.currentMultiplicityCounter=0,this.currentMultiplicityTotal=parseInt(this.multiplicity.next(0)),this.currentPush=this.push.next(0),this.P.x=e,this.P.y=i,this.hasNext=!0,!0)}getIntensity(){return this.intensity}getMultiplicity(){return this.multiplicity}getPush(){return this.push}next(){if(this.hasNext){this.currentMultiplicityCounter++,this.hasNext=this.currentMultiplicityCounter<this.currentMultiplicityTotal;let t=this.nextRotation(0);if(this.currentPush){let e=Z4Vector.fromVector(this.P.x,this.P.y,this.currentPush,t);this.z4Point.setZ4Vector(Z4Vector.fromVector(e.getX(),e.getY(),this.intensity.next(0),t))}else this.z4Point.setZ4Vector(Z4Vector.fromVector(this.P.x,this.P.y,this.intensity.next(0),t));if(this.nextSide(this.z4Point,null),this.progression===Z4Progression.TEMPORAL){this.z4Point.setLighting(this.lighting);let t=this.z4Point.getColorPosition();t=-1===t?0:t+this.temporalStepProgression,t>1&&(t-=1),this.z4Point.setColorPosition(t)}else this.progression===Z4Progression.SPATIAL?(this.z4Point.setLighting(Z4Lighting.NONE),this.z4Point.setColorPosition(-1)):this.progression!==Z4Progression.RELATIVE_TO_PATH&&this.progression!==Z4Progression.RANDOM||(this.z4Point.setLighting(this.lighting),this.z4Point.setColorPosition(Math.random()));return this.z4Point}return null}drawDemo(t,e,i){let o=new Z4ArrowPainter,s=new Z4GradientColor;this.initDraw(e,i).forEach((e=>{this.draw(Z4Action.START,e.x,e.y),this.currentPush&&!this.currentMultiplicityCounter&&(t.save(),t.lineWidth=1,t.fillStyle=this.getColor("black"),t.beginPath(),t.arc(this.P.x,this.P.y,2,0,Z4Math.TWO_PI),t.fill(),t.restore());let i=null;for(;null!==(i=this.next());){let e=i.getZ4Vector();t.save(),t.translate(e.getX0(),e.getY0()),t.rotate(e.getPhase()),o.draw(t,i,s),t.restore()}}))}initDraw(t,e){let i=new Array;for(let o=50;o<=t-50;o+=100)for(let t=50;t<=e-50;t+=100){let e=new Object;e.x=o,e.y=t,i.push(e)}return i}}class Z4StamperUI extends Z4ComponentUI{intensity=(new Z4FancifulValueUI).setValueLabel("INTENSITY").setComponentsVisible(!0,!0,!1).setSignsVisible(!1,!0,!0).appendTo(this.querySelector(".stamper-container"));multiplicity=(new Z4FancifulValueUI).setValueLabel("MULTIPLICITY").setComponentsVisible(!0,!0,!1).setSignsVisible(!1,!0,!0).setConstantRange(1,999999999).appendTo(this.querySelector(".stamper-container"));push=(new Z4FancifulValueUI).setValueLabel("PUSH").setComponentsVisible(!0,!0,!1).setSignsVisible(!1,!0,!0).appendTo(this.querySelector(".stamper-container"));stamper=new Z4Stamper;static UI=Z4HTMLFactory.get("giada/pizzapazza/iterator/ui/Z4StamperUI.html");constructor(){super(Z4StamperUI.UI),this.setValue(this.stamper)}setValue(t){return this.stamper=t,this.intensity.setValue(this.stamper.getIntensity()),this.multiplicity.setValue(this.stamper.getMultiplicity()),this.push.setValue(this.stamper.getPush()),this}getValue(){return this.stamper}}
//# sourceMappingURL=bundle-0.8.0.min.js.map